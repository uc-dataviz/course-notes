<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Day 2 Showing the right numbers | Data Visualization</title>
<meta name="author" content="Benjamin Soltoff">
<meta name="description" content="library(tidyverse) library(gapminder) library(socviz) library(knitr) library(broom) library(forcats) library(stringr) library(ggrepel) library(here) Learning objectives  2.0.1 Morning Expand on...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Day 2 Showing the right numbers | Data Visualization">
<meta property="og:type" content="book">
<meta property="og:description" content="library(tidyverse) library(gapminder) library(socviz) library(knitr) library(broom) library(forcats) library(stringr) library(ggrepel) library(here) Learning objectives  2.0.1 Morning Expand on...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Day 2 Showing the right numbers | Data Visualization">
<meta name="twitter:description" content="library(tidyverse) library(gapminder) library(socviz) library(knitr) library(broom) library(forcats) library(stringr) library(ggrepel) library(here) Learning objectives  2.0.1 Morning Expand on...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.21/datatables.js"></script><link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="MACS 20700/40700">Data Visualization</a>:
        <small class="text-muted">MACS 20700/40700</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Syllabus</a></li>
<li><a class="" href="intro-data-viz.html"><span class="header-section-number">1</span> Introduction to data visualization</a></li>
<li><a class="active" href="show-the-numbers.html"><span class="header-section-number">2</span> Showing the right numbers</a></li>
<li><a class="" href="science-polish.html"><span class="header-section-number">3</span> Making plots pretty and clean</a></li>
<li><a class="" href="geoviz.html"><span class="header-section-number">4</span> Geospatial visualizations</a></li>
<li><a class="" href="shiny.html"><span class="header-section-number">5</span> Shiny applications</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="show-the-numbers" class="section level1" number="2">
<h1>
<span class="header-section-number">Day 2</span> Showing the right numbers<a class="anchor" aria-label="anchor" href="#show-the-numbers"><i class="fas fa-link"></i></a>
</h1>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jennybc/gapminder">gapminder</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://kjhealy.github.io/socviz/">socviz</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org">forcats</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org">stringr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slowkow/ggrepel">ggrepel</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></code></pre></div>
<div id="learning-objectives-1" class="section level2 unnumbered">
<h2>Learning objectives<a class="anchor" aria-label="anchor" href="#learning-objectives-1"><i class="fas fa-link"></i></a>
</h2>
<div id="morning-1" class="section level3" number="2.0.1">
<h3>
<span class="header-section-number">2.0.1</span> Morning<a class="anchor" aria-label="anchor" href="#morning-1"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Expand on the different types of geometric objects used by <code>ggplot2</code>
</li>
<li>Demonstrate the ability of <code>ggplot2</code> to calculate statistical transformations</li>
<li>Review the grammar of graphics and <code>ggplot2</code> workflow</li>
<li>Combine <code>ggplot2</code> with <code>dplyr</code> and data transformation prior to constructing the graph</li>
</ul>
</div>
<div id="afternoon-1" class="section level3" number="2.0.2">
<h3>
<span class="header-section-number">2.0.2</span> Afternoon<a class="anchor" aria-label="anchor" href="#afternoon-1"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Demonstrate techniques for mapping data to graphics</li>
<li>Introduce alternative visualizations for displaying amounts and proportions</li>
<li>Consider advanced visualizations for comparisons</li>
</ul>
</div>
</div>
<div id="assigned-readings-1" class="section level2 unnumbered">
<h2>Assigned readings<a class="anchor" aria-label="anchor" href="#assigned-readings-1"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Chapters 4-5, <span class="citation">Healy (<a href="references.html#ref-healy2018data" role="doc-biblioref">2018</a>)</span> - accessible via the <a href="https://socviz.co/">book’s website</a>
</li>
</ul>
</div>
<div id="grammar-of-graphics-review" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Grammar of graphics (review)<a class="anchor" aria-label="anchor" href="#grammar-of-graphics-review"><i class="fas fa-link"></i></a>
</h2>
<p>The <strong>grammar of graphics</strong> is a set of rules for how to produce graphics from data, taking <strong>pieces of data</strong> and <strong>mapping</strong> them to <strong>geometric objects</strong> (like points and lines) that have <strong>aesthetic attributes</strong> (like position, color, and size), together with further rules for <strong>transforming the data if needed</strong>, adjusting <strong>scales</strong>, or projecting the results onto a <strong>coordinate system</strong>.</p>
</div>
<div id="grouped-data-and-the-group-aesthetic" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Grouped data and the <code>group</code> aesthetic<a class="anchor" aria-label="anchor" href="#grouped-data-and-the-group-aesthetic"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">gapminder</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">year</span>,
    y <span class="op">=</span> <span class="va">gdpPercap</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/gapminder-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>This doesn’t look right. It is trying to draw a single line for all the observations. But look at the structure of <code>gapminder</code>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gapminder</span>
<span class="co">## # A tibble: 1,704 × 6</span>
<span class="co">##    country     continent  year lifeExp      pop gdpPercap</span>
<span class="co">##    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;</span>
<span class="co">##  1 Afghanistan Asia       1952    28.8  8425333      779.</span>
<span class="co">##  2 Afghanistan Asia       1957    30.3  9240934      821.</span>
<span class="co">##  3 Afghanistan Asia       1962    32.0 10267083      853.</span>
<span class="co">##  4 Afghanistan Asia       1967    34.0 11537966      836.</span>
<span class="co">##  5 Afghanistan Asia       1972    36.1 13079460      740.</span>
<span class="co">##  6 Afghanistan Asia       1977    38.4 14880372      786.</span>
<span class="co">##  7 Afghanistan Asia       1982    39.9 12881816      978.</span>
<span class="co">##  8 Afghanistan Asia       1987    40.8 13867957      852.</span>
<span class="co">##  9 Afghanistan Asia       1992    41.7 16317921      649.</span>
<span class="co">## 10 Afghanistan Asia       1997    41.8 22227415      635.</span>
<span class="co">## # … with 1,694 more rows</span></code></pre></div>
<p>It is one-row-per-country-per-year. We use <code>group</code> to identify the column that tells us this structure so we draw one line per country.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gapminder</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">year</span>,
  y <span class="op">=</span> <span class="va">gdpPercap</span>
<span class="op">)</span><span class="op">)</span>
<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">country</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/gapminder-group-1.png" width="80%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">gapminder</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">year</span>,
    y <span class="op">=</span> <span class="va">gdpPercap</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>
  mapping <span class="op">=</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">country</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">continent</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/gapminder-facet-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>A <strong>facet</strong> is not a geom. It is a way of arranging geoms. Facet’s use R’s formula syntax. Read the <code>~</code> as “on” or “by”.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>
  color <span class="op">=</span> <span class="st">"gray70"</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">country</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>
    size <span class="op">=</span> <span class="fl">1.1</span>,
    method <span class="op">=</span> <span class="st">"loess"</span>,
    se <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_log10</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/label_dollar.html">dollar</a></span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">continent</span>, ncol <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Year"</span>,
    y <span class="op">=</span> <span class="st">"GDP per capita"</span>,
    title <span class="op">=</span> <span class="st">"GDP per capita on Five Continents"</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/labs-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>The <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code> function lets you name labels, title, subtitle, etc.</p>
</div>
<div id="geoms-can-transform-data" class="section level2" number="2.3">
<h2>
<span class="header-section-number">2.3</span> Geoms can transform data<a class="anchor" aria-label="anchor" href="#geoms-can-transform-data"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gss_sm</span>
<span class="co">## # A tibble: 2,867 × 32</span>
<span class="co">##     year    id ballot       age childs sibs   degree race  sex   region income16</span>
<span class="co">##    &lt;dbl&gt; &lt;dbl&gt; &lt;labelled&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;labe&gt; &lt;fct&gt;  &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt;   </span>
<span class="co">##  1  2016     1 1             47      3 2      Bache… White Male  New E… $170000…</span>
<span class="co">##  2  2016     2 2             61      0 3      High … White Male  New E… $50000 …</span>
<span class="co">##  3  2016     3 3             72      2 3      Bache… White Male  New E… $75000 …</span>
<span class="co">##  4  2016     4 1             43      4 3      High … White Fema… New E… $170000…</span>
<span class="co">##  5  2016     5 3             55      2 2      Gradu… White Fema… New E… $170000…</span>
<span class="co">##  6  2016     6 2             53      2 2      Junio… White Fema… New E… $60000 …</span>
<span class="co">##  7  2016     7 1             50      2 2      High … White Male  New E… $170000…</span>
<span class="co">##  8  2016     8 3             23      3 6      High … Other Fema… Middl… $30000 …</span>
<span class="co">##  9  2016     9 1             45      3 5      High … Black Male  Middl… $60000 …</span>
<span class="co">## 10  2016    10 3             71      4 1      Junio… White Male  Middl… $60000 …</span>
<span class="co">## # … with 2,857 more rows, and 21 more variables: relig &lt;fct&gt;, marital &lt;fct&gt;,</span>
<span class="co">## #   padeg &lt;fct&gt;, madeg &lt;fct&gt;, partyid &lt;fct&gt;, polviews &lt;fct&gt;, happy &lt;fct&gt;,</span>
<span class="co">## #   partners &lt;fct&gt;, grass &lt;fct&gt;, zodiac &lt;fct&gt;, pres12 &lt;labelled&gt;,</span>
<span class="co">## #   wtssall &lt;dbl&gt;, income_rc &lt;fct&gt;, agegrp &lt;fct&gt;, ageq &lt;fct&gt;, siblings &lt;fct&gt;,</span>
<span class="co">## #   kids &lt;fct&gt;, religion &lt;fct&gt;, bigregion &lt;fct&gt;, partners_rc &lt;fct&gt;, obama &lt;dbl&gt;</span></code></pre></div>
<p><code>gss_sm</code> contains a subset of General Social Survey questions from 2016.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gss_sm</span>, <span class="va">religion</span><span class="op">)</span>
<span class="co">## # A tibble: 6 × 2</span>
<span class="co">##   religion       n</span>
<span class="co">##   &lt;fct&gt;      &lt;int&gt;</span>
<span class="co">## 1 Protestant  1371</span>
<span class="co">## 2 Catholic     649</span>
<span class="co">## 3 Jewish        51</span>
<span class="co">## 4 None         619</span>
<span class="co">## 5 Other        159</span>
<span class="co">## 6 &lt;NA&gt;          18</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">gss_sm</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bigregion</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/obtain-count-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>The <code>y</code>-axis variable <code>count</code> is not in the data. Instead, ggplot has calculated it for us. It does this by using the default <code>stat_*()</code> function associated with <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">stat_count()</a></code>. This function can compute two new variables, <code>count</code> and <code>prop</code> (short for <strong>proportion</strong>). The <code>count</code> statistic is the default one used.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">gss_sm</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bigregion</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">stat</a></span><span class="op">(</span><span class="va">prop</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/prop-wrong-1.png" width="80%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">gss_sm</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bigregion</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">stat</a></span><span class="op">(</span><span class="va">prop</span><span class="op">)</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/prop-right-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>By default <code>stat(prop)</code> is calculated within each bar. If you want to calculate the proportion of all the rows in the data frame, add <code>group = 1</code>.</p>
</div>
<div id="geom_-functions-call-their-default-stat_-functions-behind-the-scenes" class="section level2" number="2.4">
<h2>
<span class="header-section-number">2.4</span> <code>geom_*()</code> functions call their default <code>stat_*()</code> functions behind the scenes<a class="anchor" aria-label="anchor" href="#geom_-functions-call-their-default-stat_-functions-behind-the-scenes"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">stat_count</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div id="color-in-a-bar-chart" class="section level3" number="2.4.1">
<h3>
<span class="header-section-number">2.4.1</span> Color in a bar chart<a class="anchor" aria-label="anchor" href="#color-in-a-bar-chart"><i class="fas fa-link"></i></a>
</h3>
<p>If you want to use color as an aesthetic to communicate additional information in a bar chart, pass it using the <code>fill</code> aesthetic. <code>color</code> defines the border of the bar.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">gss_sm</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">religion</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/bar-chart-color-1.png" width="80%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">gss_sm</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">religion</span>, color <span class="op">=</span> <span class="va">religion</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/bar-chart-color-2.png" width="80%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">gss_sm</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">religion</span>, fill <span class="op">=</span> <span class="va">religion</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/bar-chart-color-3.png" width="80%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">gss_sm</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">religion</span>, fill <span class="op">=</span> <span class="va">religion</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/bar-chart-color-4.png" width="80%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="histograms-and-kernel-densities" class="section level2" number="2.5">
<h2>
<span class="header-section-number">2.5</span> Histograms and kernel densities<a class="anchor" aria-label="anchor" href="#histograms-and-kernel-densities"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">midwest</span>
<span class="co">## # A tibble: 437 × 28</span>
<span class="co">##      PID county  state  area poptotal popdensity popwhite popblack popamerindian</span>
<span class="co">##    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;    &lt;int&gt;      &lt;dbl&gt;    &lt;int&gt;    &lt;int&gt;         &lt;int&gt;</span>
<span class="co">##  1   561 ADAMS   IL    0.052    66090      1271.    63917     1702            98</span>
<span class="co">##  2   562 ALEXAN… IL    0.014    10626       759      7054     3496            19</span>
<span class="co">##  3   563 BOND    IL    0.022    14991       681.    14477      429            35</span>
<span class="co">##  4   564 BOONE   IL    0.017    30806      1812.    29344      127            46</span>
<span class="co">##  5   565 BROWN   IL    0.018     5836       324.     5264      547            14</span>
<span class="co">##  6   566 BUREAU  IL    0.05     35688       714.    35157       50            65</span>
<span class="co">##  7   567 CALHOUN IL    0.017     5322       313.     5298        1             8</span>
<span class="co">##  8   568 CARROLL IL    0.027    16805       622.    16519      111            30</span>
<span class="co">##  9   569 CASS    IL    0.024    13437       560.    13384       16             8</span>
<span class="co">## 10   570 CHAMPA… IL    0.058   173025      2983.   146506    16559           331</span>
<span class="co">## # … with 427 more rows, and 19 more variables: popasian &lt;int&gt;, popother &lt;int&gt;,</span>
<span class="co">## #   percwhite &lt;dbl&gt;, percblack &lt;dbl&gt;, percamerindan &lt;dbl&gt;, percasian &lt;dbl&gt;,</span>
<span class="co">## #   percother &lt;dbl&gt;, popadults &lt;int&gt;, perchsd &lt;dbl&gt;, percollege &lt;dbl&gt;,</span>
<span class="co">## #   percprof &lt;dbl&gt;, poppovertyknown &lt;int&gt;, percpovertyknown &lt;dbl&gt;,</span>
<span class="co">## #   percbelowpoverty &lt;dbl&gt;, percchildbelowpovert &lt;dbl&gt;, percadultpoverty &lt;dbl&gt;,</span>
<span class="co">## #   percelderlypoverty &lt;dbl&gt;, inmetro &lt;int&gt;, category &lt;chr&gt;</span></code></pre></div>
<p><code>midwest</code> contains county-level census data for Midwestern states.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">midwest</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">area</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/histogram-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>The default <code>stat</code> for this geom has to make a choice, so the message is letting us know we might want to override it.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">midwest</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">area</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/histogram-10-bins-1.png" width="80%" style="display: block; margin: auto;"></div>
<div id="subsetting-data-on-the-fly" class="section level3" number="2.5.1">
<h3>
<span class="header-section-number">2.5.1</span> Subsetting data on the fly<a class="anchor" aria-label="anchor" href="#subsetting-data-on-the-fly"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">oh_wi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"OH"</span>, <span class="st">"WI"</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">midwest</span>, <span class="va">state</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">oh_wi</span><span class="op">)</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">percollege</span>, fill <span class="op">=</span> <span class="va">state</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>
  position <span class="op">=</span> <span class="st">"identity"</span>,
  alpha <span class="op">=</span> <span class="fl">0.4</span>, bins <span class="op">=</span> <span class="fl">20</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/unnamed-chunk-1-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>While this can be done, it is somewhat challenging to read intuitively. You must use <code>alpha</code> to incorporate transparency otherwise all hope at interpreting is lost.</p>
<p>Alternatively, you could use a continuous counterpart, <code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density()</a></code>.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">midwest</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">area</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/density-1.png" width="80%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">midwest</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">area</span>,
    fill <span class="op">=</span> <span class="va">state</span>,
    color <span class="op">=</span> <span class="va">state</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/density-fill-1.png" width="80%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="avoiding-transformations-when-necessary" class="section level2" number="2.6">
<h2>
<span class="header-section-number">2.6</span> Avoiding transformations when necessary<a class="anchor" aria-label="anchor" href="#avoiding-transformations-when-necessary"><i class="fas fa-link"></i></a>
</h2>
<p>Sometimes no transformation is necessary. Consider the <code>titanic</code> dataset</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">titanic</span>
<span class="co">##       fate    sex    n percent</span>
<span class="co">## 1 perished   male 1364    62.0</span>
<span class="co">## 2 perished female  126     5.7</span>
<span class="co">## 3 survived   male  367    16.7</span>
<span class="co">## 4 survived female  344    15.6</span></code></pre></div>
<p>Here the data has already been summarized. What if we want to make a bar chart?</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">titanic</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">fate</span>,
    y <span class="op">=</span> <span class="va">percent</span>,
    fill <span class="op">=</span> <span class="va">sex</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>
  stat <span class="op">=</span> <span class="st">"identity"</span>,
  position <span class="op">=</span> <span class="st">"dodge"</span>
<span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/titanic-bar-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Even more conveniently, use <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col()</a></code></p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">titanic</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">fate</span>,
  y <span class="op">=</span> <span class="va">percent</span>,
  fill <span class="op">=</span> <span class="va">sex</span>
<span class="op">)</span><span class="op">)</span>

<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/titanic-col-1.png" width="80%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">oecd_sum</span>
<span class="co">## # A tibble: 57 × 5</span>
<span class="co">## # Groups:   year [57]</span>
<span class="co">##     year other   usa  diff hi_lo</span>
<span class="co">##    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;</span>
<span class="co">##  1  1960  68.6  69.9 1.30  Below</span>
<span class="co">##  2  1961  69.2  70.4 1.20  Below</span>
<span class="co">##  3  1962  68.9  70.2 1.30  Below</span>
<span class="co">##  4  1963  69.1  70   0.900 Below</span>
<span class="co">##  5  1964  69.5  70.3 0.800 Below</span>
<span class="co">##  6  1965  69.6  70.3 0.700 Below</span>
<span class="co">##  7  1966  69.9  70.3 0.400 Below</span>
<span class="co">##  8  1967  70.1  70.7 0.600 Below</span>
<span class="co">##  9  1968  70.1  70.4 0.300 Below</span>
<span class="co">## 10  1969  70.1  70.6 0.5   Below</span>
<span class="co">## # … with 47 more rows</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">oecd_sum</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">diff</span>, fill <span class="op">=</span> <span class="va">hi_lo</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"Difference in Years"</span>,
  title <span class="op">=</span> <span class="st">"The US Life Expectancy Gap"</span>, subtitle <span class="op">=</span> <span class="st">"Difference between US and OECD
average life expectancies, 1960-2015"</span>,
  caption <span class="op">=</span> <span class="st">"Data: OECD. After a chart by Christopher Ingraham,
Washington Post, December 27th 2017."</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/oecd-1.png" width="80%" style="display: block; margin: auto;"></div>
</div>
<div id="cross-tabulation-the-awkward-way" class="section level2" number="2.7">
<h2>
<span class="header-section-number">2.7</span> Cross-tabulation the awkward way<a class="anchor" aria-label="anchor" href="#cross-tabulation-the-awkward-way"><i class="fas fa-link"></i></a>
</h2>
<p>More commonly, we would add color to a bar graph to cross-classify two categorical variables. This is the graphical equivalent of a frequency table. We can do this directly within <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, however it is also more convoluted.</p>
<p>Consider examining religious preference by census region.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">gss_sm</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">bigregion</span>,
    fill <span class="op">=</span> <span class="va">religion</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/region-religion-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>By default we get a stacked bar chart. If we want to make comparisons easier, we could convert this to a proportional bar chart.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">gss_sm</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">bigregion</span>,
    fill <span class="op">=</span> <span class="va">religion</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/region-religion-fill-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Now all the bars are the same height, but we lost the ability to see the relative size of each region with respect to the overall total. What if we wanted to show the proportion of religions within regions of the country, but instead of stacking the bars we want separate bars? The first attempt may use <code>position = "dodge"</code>.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">gss_sm</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">bigregion</span>,
    fill <span class="op">=</span> <span class="va">religion</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/region-religion-dodge-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Good structure, but we’re back to counts. Let’s directly map the <code>stat(prop)</code> variable to the <code>y</code> aesthetic as well to preserve the proportion on the y-axis.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">gss_sm</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">bigregion</span>,
    fill <span class="op">=</span> <span class="va">religion</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">stat</a></span><span class="op">(</span><span class="va">prop</span><span class="op">)</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/region-religion-dodge-prop-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Still not correct. Same problem as before. Each individual bar sums to 1. If we want overall proportions for a single variable, we mapped <code>group = 1</code>. What if we do that here but with respect to <code>religion</code>?</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">gss_sm</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">bigregion</span>,
    fill <span class="op">=</span> <span class="va">religion</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">stat</a></span><span class="op">(</span><span class="va">prop</span><span class="op">)</span>,
    group <span class="op">=</span> <span class="va">religion</span>
  <span class="op">)</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/region-religion-dodge-prop-religion-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Looks better, but we still have a problem. Bars within a single region do not sum to 1. Instead, bars for any particular religion sum to 1.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">gss_sm</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">religion</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">stat</a></span><span class="op">(</span><span class="va">prop</span><span class="op">)</span>,
    group <span class="op">=</span> <span class="va">bigregion</span>
  <span class="op">)</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">bigregion</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/region-religion-facet-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>The easiest approach is to use <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> and not force <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">stat_count()</a></code> to do all the work in a single step. Instead, we can ask <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> to give us a proportional bar chart of religious affiliation, and then facet that by region. The proportions are calculated within each panel, which is the breakdown we wanted. This has the added advantage of not producing too many bars within each category.</p>
<div id="calculate-manually" class="section level3" number="2.7.1">
<h3>
<span class="header-section-number">2.7.1</span> Calculate manually<a class="anchor" aria-label="anchor" href="#calculate-manually"><i class="fas fa-link"></i></a>
</h3>
<p>Rather than doing all the summarizing in <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, we could instead calculate the frequencies and proportions manually using <code>dplyr</code> functions first, then use the summarized data frame as the basis for the bar graph.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">gss_sm</span><span class="op">)</span>
<span class="co">## Rows: 2,867</span>
<span class="co">## Columns: 32</span>
<span class="co">## $ year        &lt;dbl&gt; 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2016…</span>
<span class="co">## $ id          &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,…</span>
<span class="co">## $ ballot      &lt;labelled&gt; 1, 2, 3, 1, 3, 2, 1, 3, 1, 3, 2, 1, 2, 3, 2, 3, 3, 2,…</span>
<span class="co">## $ age         &lt;dbl&gt; 47, 61, 72, 43, 55, 53, 50, 23, 45, 71, 33, 86, 32, 60, 76…</span>
<span class="co">## $ childs      &lt;dbl&gt; 3, 0, 2, 4, 2, 2, 2, 3, 3, 4, 5, 4, 3, 5, 7, 2, 6, 5, 0, 2…</span>
<span class="co">## $ sibs        &lt;labelled&gt; 2, 3, 3, 3, 2, 2, 2, 6, 5, 1, 4, 4, 3, 6, 0, 1, 3, 8,…</span>
<span class="co">## $ degree      &lt;fct&gt; Bachelor, High School, Bachelor, High School, Graduate, Ju…</span>
<span class="co">## $ race        &lt;fct&gt; White, White, White, White, White, White, White, Other, Bl…</span>
<span class="co">## $ sex         &lt;fct&gt; Male, Male, Male, Female, Female, Female, Male, Female, Ma…</span>
<span class="co">## $ region      &lt;fct&gt; New England, New England, New England, New England, New En…</span>
<span class="co">## $ income16    &lt;fct&gt; $170000 or over, $50000 to 59999, $75000 to $89999, $17000…</span>
<span class="co">## $ relig       &lt;fct&gt; None, None, Catholic, Catholic, None, None, None, Catholic…</span>
<span class="co">## $ marital     &lt;fct&gt; Married, Never Married, Married, Married, Married, Married…</span>
<span class="co">## $ padeg       &lt;fct&gt; Graduate, Lt High School, High School, NA, Bachelor, NA, H…</span>
<span class="co">## $ madeg       &lt;fct&gt; High School, High School, Lt High School, High School, Hig…</span>
<span class="co">## $ partyid     &lt;fct&gt; "Independent", "Ind,near Dem", "Not Str Republican", "Not …</span>
<span class="co">## $ polviews    &lt;fct&gt; Moderate, Liberal, Conservative, Moderate, Slightly Libera…</span>
<span class="co">## $ happy       &lt;fct&gt; Pretty Happy, Pretty Happy, Very Happy, Pretty Happy, Very…</span>
<span class="co">## $ partners    &lt;fct&gt; NA, "1 Partner", "1 Partner", NA, "1 Partner", "1 Partner"…</span>
<span class="co">## $ grass       &lt;fct&gt; NA, Legal, Not Legal, NA, Legal, Legal, NA, Not Legal, NA,…</span>
<span class="co">## $ zodiac      &lt;fct&gt; Aquarius, Scorpio, Pisces, Cancer, Scorpio, Scorpio, Capri…</span>
<span class="co">## $ pres12      &lt;labelled&gt; 3, 1, 2, 2, 1, 1, NA, NA, NA, 2, NA, NA, 1, 1, 2, 1, …</span>
<span class="co">## $ wtssall     &lt;dbl&gt; 0.957, 0.478, 0.957, 1.914, 1.435, 0.957, 1.435, 0.957, 0.…</span>
<span class="co">## $ income_rc   &lt;fct&gt; Gt $170000, Gt $50000, Gt $75000, Gt $170000, Gt $170000, …</span>
<span class="co">## $ agegrp      &lt;fct&gt; Age 45-55, Age 55-65, Age 65+, Age 35-45, Age 45-55, Age 4…</span>
<span class="co">## $ ageq        &lt;fct&gt; Age 34-49, Age 49-62, Age 62+, Age 34-49, Age 49-62, Age 4…</span>
<span class="co">## $ siblings    &lt;fct&gt; 2, 3, 3, 3, 2, 2, 2, 6+, 5, 1, 4, 4, 3, 6+, 0, 1, 3, 6+, 2…</span>
<span class="co">## $ kids        &lt;fct&gt; 3, 0, 2, 4+, 2, 2, 2, 3, 3, 4+, 4+, 4+, 3, 4+, 4+, 2, 4+, …</span>
<span class="co">## $ religion    &lt;fct&gt; None, None, Catholic, Catholic, None, None, None, Catholic…</span>
<span class="co">## $ bigregion   &lt;fct&gt; Northeast, Northeast, Northeast, Northeast, Northeast, Nor…</span>
<span class="co">## $ partners_rc &lt;fct&gt; NA, 1, 1, NA, 1, 1, NA, 1, NA, 3, 1, NA, 1, NA, 0, 1, 0, N…</span>
<span class="co">## $ obama       &lt;dbl&gt; 0, 1, 0, 0, 1, 1, NA, NA, NA, 0, NA, NA, 1, 1, 0, 1, 0, 1,…</span>

<span class="op">(</span><span class="va">rel_by_region</span> <span class="op">&lt;-</span> <span class="va">gss_sm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">bigregion</span>, <span class="va">religion</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    freq <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,
    pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">freq</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">## # A tibble: 20 × 5</span>
<span class="co">##    bigregion religion       n    freq   pct</span>
<span class="co">##    &lt;fct&gt;     &lt;fct&gt;      &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">##  1 Northeast Protestant   158 0.0551      6</span>
<span class="co">##  2 Northeast Catholic     162 0.0565      6</span>
<span class="co">##  3 Northeast Jewish        27 0.00942     1</span>
<span class="co">##  4 Northeast None         112 0.0391      4</span>
<span class="co">##  5 Northeast Other         28 0.00977     1</span>
<span class="co">##  6 Midwest   Protestant   325 0.113      11</span>
<span class="co">##  7 Midwest   Catholic     172 0.0600      6</span>
<span class="co">##  8 Midwest   Jewish         3 0.00105     0</span>
<span class="co">##  9 Midwest   None         157 0.0548      5</span>
<span class="co">## 10 Midwest   Other         33 0.0115      1</span>
<span class="co">## 11 South     Protestant   650 0.227      23</span>
<span class="co">## 12 South     Catholic     160 0.0558      6</span>
<span class="co">## 13 South     Jewish        11 0.00384     0</span>
<span class="co">## 14 South     None         170 0.0593      6</span>
<span class="co">## 15 South     Other         50 0.0174      2</span>
<span class="co">## 16 West      Protestant   238 0.0830      8</span>
<span class="co">## 17 West      Catholic     155 0.0541      5</span>
<span class="co">## 18 West      Jewish        10 0.00349     0</span>
<span class="co">## 19 West      None         180 0.0628      6</span>
<span class="co">## 20 West      Other         48 0.0167      2</span></code></pre></div>
<p>Now this is easy to pass into <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> and draw the bar graph.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">rel_by_region</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">bigregion</span>,
    y <span class="op">=</span> <span class="va">pct</span>,
    fill <span class="op">=</span> <span class="va">religion</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Region"</span>, y <span class="op">=</span> <span class="st">"Percent"</span>, fill <span class="op">=</span> <span class="st">"Religion"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/rel-by-region-plot-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Instead of using <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code>, we use <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col()</a></code> because we already summarized the data - we want <code><a href="https://ggplot2.tidyverse.org/reference/stat_identity.html">stat_identity()</a></code>, not <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">stat_count()</a></code>. While this figure works, it is not the best we can do. It is generally crowded. Instead, let’s convert it to a faceted plot:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">rel_by_region</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">religion</span>,
    y <span class="op">=</span> <span class="va">pct</span>,
    fill <span class="op">=</span> <span class="va">religion</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Region"</span>, y <span class="op">=</span> <span class="st">"Percent"</span>, fill <span class="op">=</span> <span class="st">"Religion"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">bigregion</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/rel-by-region-plot-facet-1.png" width="80%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="continuous-variables-by-group-or-category" class="section level2" number="2.8">
<h2>
<span class="header-section-number">2.8</span> Continuous variables by group or category<a class="anchor" aria-label="anchor" href="#continuous-variables-by-group-or-category"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">organdata</span><span class="op">)</span>
<span class="co">## Rows: 238</span>
<span class="co">## Columns: 21</span>
<span class="co">## $ country          &lt;chr&gt; "Australia", "Australia", "Australia", "Australia", "…</span>
<span class="co">## $ year             &lt;date&gt; NA, 1991-01-01, 1992-01-01, 1993-01-01, 1994-01-01, …</span>
<span class="co">## $ donors           &lt;dbl&gt; NA, 12.09, 12.35, 12.51, 10.25, 10.18, 10.59, 10.26, …</span>
<span class="co">## $ pop              &lt;int&gt; 17065, 17284, 17495, 17667, 17855, 18072, 18311, 1851…</span>
<span class="co">## $ pop_dens         &lt;dbl&gt; 0.220, 0.223, 0.226, 0.228, 0.231, 0.233, 0.237, 0.23…</span>
<span class="co">## $ gdp              &lt;int&gt; 16774, 17171, 17914, 18883, 19849, 21079, 21923, 2296…</span>
<span class="co">## $ gdp_lag          &lt;int&gt; 16591, 16774, 17171, 17914, 18883, 19849, 21079, 2192…</span>
<span class="co">## $ health           &lt;dbl&gt; 1300, 1379, 1455, 1540, 1626, 1737, 1846, 1948, 2077,…</span>
<span class="co">## $ health_lag       &lt;dbl&gt; 1224, 1300, 1379, 1455, 1540, 1626, 1737, 1846, 1948,…</span>
<span class="co">## $ pubhealth        &lt;dbl&gt; 4.8, 5.4, 5.4, 5.4, 5.4, 5.5, 5.6, 5.7, 5.9, 6.1, 6.2…</span>
<span class="co">## $ roads            &lt;dbl&gt; 136.6, 122.3, 112.8, 110.5, 108.0, 111.6, 107.6, 95.4…</span>
<span class="co">## $ cerebvas         &lt;int&gt; 682, 647, 630, 611, 631, 592, 576, 525, 516, 493, 474…</span>
<span class="co">## $ assault          &lt;int&gt; 21, 19, 17, 18, 17, 16, 17, 17, 16, 15, 16, 15, 14, N…</span>
<span class="co">## $ external         &lt;int&gt; 444, 425, 406, 376, 387, 371, 395, 385, 410, 409, 393…</span>
<span class="co">## $ txp_pop          &lt;dbl&gt; 0.938, 0.926, 0.915, 0.906, 0.896, 0.885, 0.874, 0.86…</span>
<span class="co">## $ world            &lt;chr&gt; "Liberal", "Liberal", "Liberal", "Liberal", "Liberal"…</span>
<span class="co">## $ opt              &lt;chr&gt; "In", "In", "In", "In", "In", "In", "In", "In", "In",…</span>
<span class="co">## $ consent_law      &lt;chr&gt; "Informed", "Informed", "Informed", "Informed", "Info…</span>
<span class="co">## $ consent_practice &lt;chr&gt; "Informed", "Informed", "Informed", "Informed", "Info…</span>
<span class="co">## $ consistent       &lt;chr&gt; "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes…</span>
<span class="co">## $ ccode            &lt;chr&gt; "Oz", "Oz", "Oz", "Oz", "Oz", "Oz", "Oz", "Oz", "Oz",…</span></code></pre></div>
<div id="boxplots" class="section level3" number="2.8.1">
<h3>
<span class="header-section-number">2.8.1</span> Boxplots<a class="anchor" aria-label="anchor" href="#boxplots"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">organdata</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">country</span>, y <span class="op">=</span> <span class="va">donors</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/organ-box-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Awkward to have country labels on x-axis. Switch to y-axis.</p>
</div>
<div id="coord_flip" class="section level3" number="2.8.2">
<h3>
<span class="header-section-number">2.8.2</span> <code>coord_flip()</code><a class="anchor" aria-label="anchor" href="#coord_flip"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">organdata</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">country</span>, y <span class="op">=</span> <span class="va">donors</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/organ-flip-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Explicit use of a coordinate transformation system.</p>
</div>
<div id="reorder" class="section level3" number="2.8.3">
<h3>
<span class="header-section-number">2.8.3</span> <code>reorder()</code><a class="anchor" aria-label="anchor" href="#reorder"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">organdata</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">donors</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="va">donors</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/organ-reorder-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Place on a more meaningful order.</p>
<p>Add color aesthetic.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">organdata</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">donors</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="va">donors</span>, fill <span class="op">=</span> <span class="va">world</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/organ-world-1.png" width="80%" style="display: block; margin: auto;"></div>
</div>
<div id="strip-chart" class="section level3" number="2.8.4">
<h3>
<span class="header-section-number">2.8.4</span> Strip chart<a class="anchor" aria-label="anchor" href="#strip-chart"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">organdata</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">donors</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="va">donors</span>, color <span class="op">=</span> <span class="va">world</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/strip-chart-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Hard to see all the points. Add jitter.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">organdata</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">donors</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="va">donors</span>, color <span class="op">=</span> <span class="va">world</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/strip-jitter-1.png" width="80%" style="display: block; margin: auto;"></div>
</div>
<div id="cleveland-dotplot" class="section level3" number="2.8.5">
<h3>
<span class="header-section-number">2.8.5</span> Cleveland dotplot<a class="anchor" aria-label="anchor" href="#cleveland-dotplot"><i class="fas fa-link"></i></a>
</h3>
<div id="calculate-summary-statistics" class="section level4" number="2.8.5.1">
<h4>
<span class="header-section-number">2.8.5.1</span> Calculate summary statistics<a class="anchor" aria-label="anchor" href="#calculate-summary-statistics"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">by_country</span> <span class="op">&lt;-</span> <span class="va">organdata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">consent_law</span>, <span class="va">country</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>
    donors_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">donors</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
    donors_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">donors</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
    gdp_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gdp</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
    health_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">health</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
    roads_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">roads</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
    cerebvas_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cerebvas</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="op">)</span><span class="op">)</span>
<span class="co">## # A tibble: 17 × 8</span>
<span class="co">## # Groups:   consent_law [2]</span>
<span class="co">##    consent_law country     donors_mean donors_sd gdp_mean health_mean roads_mean</span>
<span class="co">##    &lt;chr&gt;       &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;</span>
<span class="co">##  1 Informed    Australia          10.6     1.14    22179.       1958.      105. </span>
<span class="co">##  2 Informed    Canada             14.0     0.751   23711.       2272.      109. </span>
<span class="co">##  3 Informed    Denmark            13.1     1.47    23722.       2054.      102. </span>
<span class="co">##  4 Informed    Germany            13.0     0.611   22163.       2349.      113. </span>
<span class="co">##  5 Informed    Ireland            19.8     2.48    20824.       1480.      118. </span>
<span class="co">##  6 Informed    Netherlands        13.7     1.55    23013.       1993.       76.1</span>
<span class="co">##  7 Informed    United Kin…        13.5     0.775   21359.       1561.       67.9</span>
<span class="co">##  8 Informed    United Sta…        20.0     1.33    29212.       3988.      155. </span>
<span class="co">##  9 Presumed    Austria            23.5     2.42    23876.       1875.      150. </span>
<span class="co">## 10 Presumed    Belgium            21.9     1.94    22500.       1958.      155. </span>
<span class="co">## 11 Presumed    Finland            18.4     1.53    21019.       1615.       93.6</span>
<span class="co">## 12 Presumed    France             16.8     1.60    22603.       2160.      156. </span>
<span class="co">## 13 Presumed    Italy              11.1     4.28    21554.       1757       122. </span>
<span class="co">## 14 Presumed    Norway             15.4     1.11    26448.       2217.       70.0</span>
<span class="co">## 15 Presumed    Spain              28.1     4.96    16933        1289.      161. </span>
<span class="co">## 16 Presumed    Sweden             13.1     1.75    22415.       1951.       72.3</span>
<span class="co">## 17 Presumed    Switzerland        14.2     1.71    27233        2776.       96.4</span>
<span class="co">## # … with 1 more variable: cerebvas_mean &lt;dbl&gt;</span></code></pre></div>
<p>Better approach using efficient code.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">by_country</span> <span class="op">&lt;-</span> <span class="va">organdata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">consent_law</span>, <span class="va">country</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">mean</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">## # A tibble: 17 × 28</span>
<span class="co">##    consent_law country       donors_mean donors_sd pop_mean pop_sd pop_dens_mean</span>
<span class="co">##    &lt;chr&gt;       &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class="co">##  1 Informed    Australia            10.6     1.14    18318. 8.31e2         0.237</span>
<span class="co">##  2 Informed    Canada               14.0     0.751   29608. 1.19e3         0.297</span>
<span class="co">##  3 Informed    Denmark              13.1     1.47     5257. 8.06e1        12.2  </span>
<span class="co">##  4 Informed    Germany              13.0     0.611   80255. 5.16e3        22.5  </span>
<span class="co">##  5 Informed    Ireland              19.8     2.48     3674. 1.32e2         5.23 </span>
<span class="co">##  6 Informed    Netherlands          13.7     1.55    15548. 3.73e2        37.4  </span>
<span class="co">##  7 Informed    United Kingd…        13.5     0.775   58187. 6.26e2        24.0  </span>
<span class="co">##  8 Informed    United States        20.0     1.33   269330. 1.25e4         2.80 </span>
<span class="co">##  9 Presumed    Austria              23.5     2.42     7927. 1.09e2         9.45 </span>
<span class="co">## 10 Presumed    Belgium              21.9     1.94    10153. 1.09e2        30.7  </span>
<span class="co">## 11 Presumed    Finland              18.4     1.53     5112. 6.86e1         1.51 </span>
<span class="co">## 12 Presumed    France               16.8     1.60    58056. 8.51e2        10.5  </span>
<span class="co">## 13 Presumed    Italy                11.1     4.28    57360. 4.25e2        19.0  </span>
<span class="co">## 14 Presumed    Norway               15.4     1.11     4386. 9.73e1         1.35 </span>
<span class="co">## 15 Presumed    Spain                28.1     4.96    39666. 9.51e2         7.84 </span>
<span class="co">## 16 Presumed    Sweden               13.1     1.75     8789. 1.14e2         1.95 </span>
<span class="co">## 17 Presumed    Switzerland          14.2     1.71     7037. 1.70e2        17.0  </span>
<span class="co">## # … with 21 more variables: pop_dens_sd &lt;dbl&gt;, gdp_mean &lt;dbl&gt;, gdp_sd &lt;dbl&gt;,</span>
<span class="co">## #   gdp_lag_mean &lt;dbl&gt;, gdp_lag_sd &lt;dbl&gt;, health_mean &lt;dbl&gt;, health_sd &lt;dbl&gt;,</span>
<span class="co">## #   health_lag_mean &lt;dbl&gt;, health_lag_sd &lt;dbl&gt;, pubhealth_mean &lt;dbl&gt;,</span>
<span class="co">## #   pubhealth_sd &lt;dbl&gt;, roads_mean &lt;dbl&gt;, roads_sd &lt;dbl&gt;, cerebvas_mean &lt;dbl&gt;,</span>
<span class="co">## #   cerebvas_sd &lt;dbl&gt;, assault_mean &lt;dbl&gt;, assault_sd &lt;dbl&gt;,</span>
<span class="co">## #   external_mean &lt;dbl&gt;, external_sd &lt;dbl&gt;, txp_pop_mean &lt;dbl&gt;,</span>
<span class="co">## #   txp_pop_sd &lt;dbl&gt;</span></code></pre></div>
</div>
<div id="draw-the-plot" class="section level4" number="2.8.5.2">
<h4>
<span class="header-section-number">2.8.5.2</span> Draw the plot<a class="anchor" aria-label="anchor" href="#draw-the-plot"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">by_country</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">donors_mean</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">donors_mean</span><span class="op">)</span>,
    color <span class="op">=</span> <span class="va">consent_law</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Donor Procurement Rate"</span>,
    y <span class="op">=</span> <span class="st">""</span>, color <span class="op">=</span> <span class="st">"Consent Law"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/organ-donor-mean-1.png" width="80%" style="display: block; margin: auto;"></div>
</div>
<div id="use-facet-instead-of-color" class="section level4" number="2.8.5.3">
<h4>
<span class="header-section-number">2.8.5.3</span> Use facet instead of color<a class="anchor" aria-label="anchor" href="#use-facet-instead-of-color"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">by_country</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">donors_mean</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">donors_mean</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">consent_law</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Donor Procurement Rate"</span>,
    y <span class="op">=</span> <span class="st">""</span>, color <span class="op">=</span> <span class="st">"Consent Law"</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/organ-donor-facet-1.png" width="80%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">by_country</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">donors_mean</span>,
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">donors_mean</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">consent_law</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Donor Procurement Rate"</span>,
    y <span class="op">=</span> <span class="st">""</span>, color <span class="op">=</span> <span class="st">"Consent Law"</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/organ-free-scale-y-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Allow the <span class="math inline">\(y\)</span>-axis to vary and only include matching countries.</p>
</div>
<div id="add-standard-deviation" class="section level4" number="2.8.5.4">
<h4>
<span class="header-section-number">2.8.5.4</span> Add standard deviation<a class="anchor" aria-label="anchor" href="#add-standard-deviation"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">by_country</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">donors_mean</span><span class="op">)</span>,
    y <span class="op">=</span> <span class="va">donors_mean</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_pointrange</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    ymin <span class="op">=</span> <span class="va">donors_mean</span> <span class="op">-</span> <span class="va">donors_sd</span>,
    ymax <span class="op">=</span> <span class="va">donors_mean</span> <span class="op">+</span> <span class="va">donors_sd</span>
  <span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">""</span>,
    y <span class="op">=</span> <span class="st">"Donor Procurement Rate"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/organ-donor-sd-1.png" width="80%" style="display: block; margin: auto;"></div>
</div>
</div>
</div>
<div id="plot-text-directly" class="section level2" number="2.9">
<h2>
<span class="header-section-number">2.9</span> Plot text directly<a class="anchor" aria-label="anchor" href="#plot-text-directly"><i class="fas fa-link"></i></a>
</h2>
<div id="geom_text" class="section level3" number="2.9.1">
<h3>
<span class="header-section-number">2.9.1</span> <code>geom_text()</code><a class="anchor" aria-label="anchor" href="#geom_text"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">by_country</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">roads_mean</span>,
    y <span class="op">=</span> <span class="va">donors_mean</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">country</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/geom-text-1.png" width="80%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">by_country</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">roads_mean</span>,
    y <span class="op">=</span> <span class="va">donors_mean</span>
  <span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">country</span><span class="op">)</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/geom-text-adj-1.png" width="80%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="ggrepelgeom_text_repel" class="section level2" number="2.10">
<h2>
<span class="header-section-number">2.10</span> <code>ggrepel::geom_text_repel()</code><a class="anchor" aria-label="anchor" href="#ggrepelgeom_text_repel"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">elections_historic</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>
<span class="co">## # A tibble: 49 × 6</span>
<span class="co">##     year winner                 win_party ec_pct popular_pct popular_margin</span>
<span class="co">##    &lt;int&gt; &lt;chr&gt;                  &lt;chr&gt;      &lt;dbl&gt;       &lt;dbl&gt;          &lt;dbl&gt;</span>
<span class="co">##  1  1824 John Quincy Adams      D.-R.      0.322       0.309        -0.104 </span>
<span class="co">##  2  1828 Andrew Jackson         Dem.       0.682       0.559         0.122 </span>
<span class="co">##  3  1832 Andrew Jackson         Dem.       0.766       0.547         0.178 </span>
<span class="co">##  4  1836 Martin Van Buren       Dem.       0.578       0.508         0.142 </span>
<span class="co">##  5  1840 William Henry Harrison Whig       0.796       0.529         0.0605</span>
<span class="co">##  6  1844 James Polk             Dem.       0.618       0.495         0.0145</span>
<span class="co">##  7  1848 Zachary Taylor         Whig       0.562       0.473         0.0479</span>
<span class="co">##  8  1852 Franklin Pierce        Dem.       0.858       0.508         0.0695</span>
<span class="co">##  9  1856 James Buchanan         Dem.       0.588       0.453         0.122 </span>
<span class="co">## 10  1860 Abraham Lincoln        Rep.       0.594       0.396         0.101 </span>
<span class="co">## # … with 39 more rows</span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_title</span> <span class="op">&lt;-</span> <span class="st">"Presidential Elections: Popular &amp; Electoral College Margins"</span>
<span class="va">p_subtitle</span> <span class="op">&lt;-</span> <span class="st">"1824-2016"</span>
<span class="va">p_caption</span> <span class="op">&lt;-</span> <span class="st">"Data for 2016 are provisional."</span>
<span class="va">x_label</span> <span class="op">&lt;-</span> <span class="st">"Winner's share of Popular Vote"</span>
<span class="va">y_label</span> <span class="op">&lt;-</span> <span class="st">"Winner's share of Electoral College Votes"</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slowkow/ggrepel">ggrepel</a></span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">elections_historic</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">popular_pct</span>,
  y <span class="op">=</span> <span class="va">ec_pct</span>,
  label <span class="op">=</span> <span class="va">winner_label</span>
<span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">1.4</span>, color <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">1.4</span>, color <span class="op">=</span> <span class="st">"gray80"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/label_percent.html">percent</a></span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/label_percent.html">percent</a></span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">x_label</span>, y <span class="op">=</span> <span class="va">y_label</span>, title <span class="op">=</span> <span class="va">p_title</span>, subtitle <span class="op">=</span> <span class="va">p_subtitle</span>,
    caption <span class="op">=</span> <span class="va">p_caption</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/elections-plot-1.png" width="80%" style="display: block; margin: auto;"></div>
<div id="label-outliers-only" class="section level3" number="2.10.1">
<h3>
<span class="header-section-number">2.10.1</span> Label outliers only<a class="anchor" aria-label="anchor" href="#label-outliers-only"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">by_country</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_mean</span>, y <span class="op">=</span> <span class="va">health_mean</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">by_country</span>, <span class="va">gdp_mean</span> <span class="op">&gt;</span> <span class="fl">25000</span><span class="op">)</span>,
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">country</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/label-outliers-1.png" width="80%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">by_country</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_mean</span>, y <span class="op">=</span> <span class="va">health_mean</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span>
      <span class="va">by_country</span>,
      <span class="va">gdp_mean</span> <span class="op">&gt;</span> <span class="fl">25000</span> <span class="op">|</span> <span class="va">health_mean</span> <span class="op">&lt;</span> <span class="fl">1500</span> <span class="op">|</span>
        <span class="va">country</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="st">"Belgium"</span>
    <span class="op">)</span>,
    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">country</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/label-outliers-2.png" width="80%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="scales-guides-and-themes" class="section level2" number="2.11">
<h2>
<span class="header-section-number">2.11</span> Scales, guides, and themes<a class="anchor" aria-label="anchor" href="#scales-guides-and-themes"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">gapminder</span>,
  mapping <span class="op">=</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
      x <span class="op">=</span> <span class="va">gdpPercap</span>,
      y <span class="op">=</span> <span class="va">lifeExp</span>,
      color <span class="op">=</span> <span class="va">continent</span>, fill <span class="op">=</span> <span class="va">continent</span>
    <span class="op">)</span>
<span class="op">)</span>

<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/gapminder-scales-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Scale functions control scale mappings in geoms. Remember: not just <code>x</code> and <code>y</code> but also <code>color</code>, <code>fill</code>, <code>shape</code>, and <code>size</code> are scales. They visually represent quantities or categories in your data – thus, they have a scale associated with that
representation. This means you control things like color schemes for data mappings through <strong>scale functions</strong>.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="show-the-numbers.html#cb80-1" aria-hidden="true" tabindex="-1"></a>scale_<span class="sc">&lt;</span>MAPPING<span class="sc">&gt;</span>_<span class="sc">&lt;</span>KIND<span class="sc">&gt;</span>()</span>
<span id="cb80-2"><a href="show-the-numbers.html#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="show-the-numbers.html#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_x_continuous</span>()</span>
<span id="cb80-4"><a href="show-the-numbers.html#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_y_continuous</span>()</span>
<span id="cb80-5"><a href="show-the-numbers.html#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_x_discrete</span>()</span>
<span id="cb80-6"><a href="show-the-numbers.html#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_y_discrete</span>()</span>
<span id="cb80-7"><a href="show-the-numbers.html#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_x_log10</span>()</span>
<span id="cb80-8"><a href="show-the-numbers.html#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_x_sqrt</span>()</span></code></pre></div>
<div id="labels-breaks-and-limits" class="section level3" number="2.11.1">
<h3>
<span class="header-section-number">2.11.1</span> Labels, breaks, and limits<a class="anchor" aria-label="anchor" href="#labels-breaks-and-limits"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">organdata</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">roads</span>,
    y <span class="op">=</span> <span class="va">donors</span>, color <span class="op">=</span> <span class="va">world</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">15</span>, <span class="fl">25</span><span class="op">)</span>,
    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Five"</span>, <span class="st">"Fifteen"</span>, <span class="st">"Twenty Five"</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/labs-breaks-limits-1.png" width="80%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">organdata</span>,
  mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="va">roads</span>,
    y <span class="op">=</span> <span class="va">donors</span>, color <span class="op">=</span> <span class="va">world</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span>
  labels <span class="op">=</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="st">"Corporatist"</span>, <span class="st">"Liberal"</span>,
      <span class="st">"Social Democratic"</span>, <span class="st">"Unclassified"</span>
    <span class="op">)</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Road Deaths"</span>,
    y <span class="op">=</span> <span class="st">"Donor Procurement"</span>,
    color <span class="op">=</span> <span class="st">"Welfare State"</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/scale-color-1.png" width="80%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">organdata</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">roads</span>,
  y <span class="op">=</span> <span class="va">donors</span>, color <span class="op">=</span> <span class="va">world</span>
<span class="op">)</span><span class="op">)</span>
<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Road Deaths"</span>,
    y <span class="op">=</span> <span class="st">"Donor Procurement"</span>
  <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/guides-off-1.png" width="80%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="mapping-data-to-graphics" class="section level2" number="2.12">
<h2>
<span class="header-section-number">2.12</span> Mapping data to graphics<a class="anchor" aria-label="anchor" href="#mapping-data-to-graphics"><i class="fas fa-link"></i></a>
</h2>

<div class="rmdnote">
<p>Download the necessary data files for the following coding exercises using <code>usethis::use_course("css-data-mining-viz/show-the-numbers")</code>.</p>
</div>
<p>For this example, I’m going to use real world data to demonstrate the typical process for loading data, cleaning it up a bit, and mapping specific columns of the data onto the parts of a graph using the grammar of graphics and <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>.</p>
<p>The data I’ll use comes from the BBC’s corporate charity, <a href="https://www.bbcchildreninneed.co.uk/">BBC Children in Need</a>, which makes grants to smaller UK nonprofit organizations that work on issues related to childhood poverty. An organization in the UK named <a href="https://www.threesixtygiving.org/">360Giving</a> helps nonprofits and foundations publish data about their grant giving activities in an open and standardized way, and (as of May 2020) <a href="http://data.threesixtygiving.org/">they list data from 126 different charities</a>, including BBC Children in Need.</p>
<p>If you want to follow along with this example (highly recommended!), you can download the data directly from <a href="https://data-mining-viz.netlify.app/data/360-giving-data.xlsx">the website</a>.</p>
<div id="load-and-clean-data" class="section level3" number="2.12.1">
<h3>
<span class="header-section-number">2.12.1</span> Load and clean data<a class="anchor" aria-label="anchor" href="#load-and-clean-data"><i class="fas fa-link"></i></a>
</h3>
<p>First, we need to load a few libraries: <strong>tidyverse</strong> (as always), along with <strong>readxl</strong> for reading Excel files and <strong>lubridate</strong> for working with dates:</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load libraries</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>  <span class="co"># For ggplot, dplyr, and friends</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span>     <span class="co"># For reading Excel files</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span>  <span class="co"># For working with dates</span></code></pre></div>
<p>We’ll then load the original Excel file. I placed this file in a folder named <code>data</code> in my RStudio Project folder for this example. It’s also good practice to keep a pristine, untouched copy of your data.</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load the original Excel file</span>
<span class="va">bbc_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/360-giving-data.xlsx"</span><span class="op">)</span></code></pre></div>
<p>There may be some errors reading the file – you can ignore those in this case.</p>
<p>Next we’ll add a couple columns and clean up the data a little.</p>
<p>We’ll extract the year from the Award Date column, rename some of the longer-named columns, and make a new column that shows the duration of grants. We’ll also get rid of 2015 since there are so few observations then.</p>
<p>Note the strange use of <code>`</code>s around column names like <code>`Award Date`</code>. This is because R technically doesn’t allow special characters like spaces in column names. If there are spaces, you have to wrap the column names in backticks. Because typing backticks all the time gets tedious, we’ll use <code><a href="https://dplyr.tidyverse.org/reference/rename.html">rename()</a></code> to rename some of the columns:</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bbc</span> <span class="op">&lt;-</span> <span class="va">bbc_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="co"># Extract the year from the award date</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>grant_year <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">`Award Date`</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="co"># Rename some columns</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>grant_amount <span class="op">=</span> <span class="va">`Amount Awarded`</span>,
         grant_program <span class="op">=</span> <span class="va">`Grant Programme:Title`</span>,
         grant_duration <span class="op">=</span> <span class="va">`Planned Dates:Duration (months)`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="co"># Make a new text-based version of the duration column, recoding months</span>
  <span class="co"># between 12-23, 23-35, and 36+. The case_when() function here lets us use</span>
  <span class="co"># multiple if/else conditions at the same time.</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>grant_duration_text <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
    <span class="va">grant_duration</span> <span class="op">&gt;=</span> <span class="fl">12</span> <span class="op">&amp;</span> <span class="va">grant_duration</span> <span class="op">&lt;</span> <span class="fl">24</span> <span class="op">~</span> <span class="st">"1 year"</span>,
    <span class="va">grant_duration</span> <span class="op">&gt;=</span> <span class="fl">24</span> <span class="op">&amp;</span> <span class="va">grant_duration</span> <span class="op">&lt;</span> <span class="fl">36</span> <span class="op">~</span> <span class="st">"2 years"</span>,
    <span class="va">grant_duration</span> <span class="op">&gt;=</span> <span class="fl">36</span> <span class="op">~</span> <span class="st">"3 years"</span>
  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="co"># Get rid of anything before 2016</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">grant_year</span> <span class="op">&gt;</span> <span class="fl">2015</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="co"># Make a categorical version of the year column</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>grant_year_category <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">grant_year</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="histograms" class="section level3" number="2.12.2">
<h3>
<span class="header-section-number">2.12.2</span> Histograms<a class="anchor" aria-label="anchor" href="#histograms"><i class="fas fa-link"></i></a>
</h3>
<p>First let’s look at the distribution of grant amounts with a histogram. Map <code>grant_amount</code> to the x-axis and don’t map anything to the y-axis, since <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code> will calculate the y-axis values for us:</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bbc</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grant_amount</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/hist-basic-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Notice that ggplot warns you about bin widths. By default it will divide the data into 30 equally spaced bins, which will most likely not be the best for your data. You should <em>always</em> set your own bin width to something more appropriate. There are no rules for correct bin widths. Just don’t have them be too wide:</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bbc</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grant_amount</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">100000</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/hist-wide-bin-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Or too small:</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bbc</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grant_amount</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/hist-tiny-bins-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>£10,000 seems to fit well. It’s often helpful to add a white border to the histogram bars, too:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bbc</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grant_amount</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">10000</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/hist-good-bins-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>We can map other variables onto the plot, like mapping <code>grant_year_category</code> to the fill aesthetic:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bbc</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grant_amount</span>, fill <span class="op">=</span> <span class="va">grant_year_category</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">10000</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/hist-bad-fill-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>That gets really hard to interpret though, so we can facet by year with <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code>:</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bbc</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grant_amount</span>, fill <span class="op">=</span> <span class="va">grant_year_category</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">10000</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">grant_year</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/hist-facet-fill-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Neat!</p>
</div>
<div id="points" class="section level3" number="2.12.3">
<h3>
<span class="header-section-number">2.12.3</span> Points<a class="anchor" aria-label="anchor" href="#points"><i class="fas fa-link"></i></a>
</h3>
<p>Next let’s look at the data using points, mapping year to the x-axis and grant amount to the y-axis:</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bbc</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grant_year_category</span>, y <span class="op">=</span> <span class="va">grant_amount</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/points-initial-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>We have some serious overplotting here, with dots so thick that it looks like lines. We can fix this a couple different ways. First, we can make the points semi-transparent using <code>alpha</code>, which ranges from 0 (completely invisible) to 1 (completely solid).</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bbc</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grant_year_category</span>, y <span class="op">=</span> <span class="va">grant_amount</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/points-alpha-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>We can also randomly space the points to spread them out using <code><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter()</a></code>:</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bbc</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grant_year_category</span>, y <span class="op">=</span> <span class="va">grant_amount</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/points-jitter-default-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>One issue with this, though, is that the points are jittered along the x-axis (which is fine, since they’re all within the same year) <em>and</em> the y-axis (which is bad, since the amounts are actual numbers). We can tell ggplot to only jitter in one direction by specifying the <code>height</code> argument—we don’t want any up-and-down jittering:</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bbc</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grant_year_category</span>, y <span class="op">=</span> <span class="va">grant_amount</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/points-jitter-horizontal-only-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>There are some weird clusters around £30,000 and below. Let’s map <code>grant_program</code> to the color aesthetic, which has two categories—regular grants and small grants—and see if that helps explain why:</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bbc</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grant_year_category</span>, y <span class="op">=</span> <span class="va">grant_amount</span>, color <span class="op">=</span> <span class="va">grant_program</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/points-jitter-color-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>It does! We appear to have two different distributions of grants: small grants have a limit of £30,000, while regular grants have a much higher average amount.</p>
</div>
<div id="boxplots-1" class="section level3" number="2.12.4">
<h3>
<span class="header-section-number">2.12.4</span> Boxplots<a class="anchor" aria-label="anchor" href="#boxplots-1"><i class="fas fa-link"></i></a>
</h3>
<p>We can add summary information to the plot by only changing the <code>geom</code> we’re using. Switch from <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> to <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code>:</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bbc</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grant_year_category</span>, y <span class="op">=</span> <span class="va">grant_amount</span>, color <span class="op">=</span> <span class="va">grant_program</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/boxplot-1.png" width="80%" style="display: block; margin: auto;"></div>
</div>
<div id="summaries" class="section level3" number="2.12.5">
<h3>
<span class="header-section-number">2.12.5</span> Summaries<a class="anchor" aria-label="anchor" href="#summaries"><i class="fas fa-link"></i></a>
</h3>
<p>We can also make smaller summarized datasets with <strong>dplyr</strong> functions like <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code> and plot those. First let’s look at grant totals, averages, and counts over time:</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bbc_by_year</span> <span class="op">&lt;-</span> <span class="va">bbc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">grant_year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="co"># Make invisible subgroups for each year</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">grant_amount</span><span class="op">)</span>,  <span class="co"># Find the total awarded in each group</span>
            avg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">grant_amount</span><span class="op">)</span>,  <span class="co"># Find the average awarded in each group</span>
            number <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>  <span class="co"># n() is a special function that shows the number of rows in each group</span>

<span class="co"># Look at our summarized data</span>
<span class="va">bbc_by_year</span>
<span class="co">## # A tibble: 4 × 4</span>
<span class="co">##   grant_year    total    avg number</span>
<span class="co">##        &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;int&gt;</span>
<span class="co">## 1       2016 17290488 78238.    221</span>
<span class="co">## 2       2017 62394278 59765.   1044</span>
<span class="co">## 3       2018 61349392 60205.   1019</span>
<span class="co">## 4       2019 41388816 61136.    677</span></code></pre></div>
<p>Because we used <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize()</a></code>, R shrank our data down significantly. We now only have a row for each of the subgroups we made: one for each year. We can plot this smaller data. We’ll use <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col()</a></code> for now.</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot our summarized data</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bbc_by_year</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grant_year</span>, y <span class="op">=</span> <span class="va">avg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/plot-year-summaries-1.png" width="80%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bbc_by_year</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grant_year</span>, y <span class="op">=</span> <span class="va">total</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/plot-year-summaries-2.png" width="80%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bbc_by_year</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grant_year</span>, y <span class="op">=</span> <span class="va">number</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/plot-year-summaries-3.png" width="80%" style="display: block; margin: auto;"></div>
<p>Based on these charts, it looks like 2016 saw the largest average grant amount. In all other years, grants averaged around £60,000, but in 2016 it jumped up to £80,000. If we look at total grants, though, we can see that there were far fewer grants awarded in 2016—only 221! 2017 and 2018 were much bigger years with far more money awarded.</p>
<p>We can also use multiple aesthetics to reveal more information from the data. First we’ll make a new small summary dataset and group by both year and grant program. With those groups, we’ll again calculate the total, average, and number.</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bbc_year_size</span> <span class="op">&lt;-</span> <span class="va">bbc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">grant_year</span>, <span class="va">grant_program</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">grant_amount</span><span class="op">)</span>,
            avg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">grant_amount</span><span class="op">)</span>,
            number <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">bbc_year_size</span>
<span class="co">## # A tibble: 8 × 5</span>
<span class="co">## # Groups:   grant_year [4]</span>
<span class="co">##   grant_year grant_program    total    avg number</span>
<span class="co">##        &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;  &lt;dbl&gt;  &lt;int&gt;</span>
<span class="co">## 1       2016 Main Grants   16405586 86345.    190</span>
<span class="co">## 2       2016 Small Grants    884902 28545.     31</span>
<span class="co">## 3       2017 Main Grants   48502923 90154.    538</span>
<span class="co">## 4       2017 Small Grants  13891355 27453.    506</span>
<span class="co">## 5       2018 Main Grants   47347789 95652.    495</span>
<span class="co">## 6       2018 Small Grants  14001603 26721.    524</span>
<span class="co">## 7       2019 Main Grants   33019492 96267.    343</span>
<span class="co">## 8       2019 Small Grants   8369324 25058.    334</span></code></pre></div>
<p>Next we’ll plot the data, mapping the <code>grant_program</code> column to the <code>fill</code> aesthetic:</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bbc_year_size</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grant_year</span>, y <span class="op">=</span> <span class="va">total</span>, fill <span class="op">=</span> <span class="va">grant_program</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/plot-year-size-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>By default, ggplot will stack the different fill colors within the same bar, but this makes it a little hard to make comparisons. While we can see that the average small grant amount was a little bigger in 2017 than in 2019, it’s harder to compare average main grant amount, since the bottoms of those sections don’t align.</p>
<p>To fix this, we can use <code><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge()</a></code> to tell the columns to fit side-by-side:</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bbc_year_size</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grant_year</span>, y <span class="op">=</span> <span class="va">total</span>, fill <span class="op">=</span> <span class="va">grant_program</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/plot-year-size-dodge-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Instead of dodging, we can also facet by <code>grant_program</code> to separate the bars:</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bbc_year_size</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grant_year</span>, y <span class="op">=</span> <span class="va">total</span>, fill <span class="op">=</span> <span class="va">grant_program</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">grant_program</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/plot-year-size-facet-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>We can put these in one column if we want:</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bbc_year_size</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grant_year</span>, y <span class="op">=</span> <span class="va">total</span>, fill <span class="op">=</span> <span class="va">grant_program</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">grant_program</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/plot-year-size-col-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Finally, we can include even more variables! We have a lot of aesthetics we can work with (<code>size</code>, <code>alpha</code>, <code>color</code>, <code>fill</code>, <code>linetype</code>, etc.), as well as facets, so let’s add one more to show the duration of the awarded grant.</p>
<p>First we’ll make another smaller summarized dataset, grouping by year, program, and duration and summarizing the total, average, and number of awards.</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bbc_year_size_duration</span> <span class="op">&lt;-</span> <span class="va">bbc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">grant_year</span>, <span class="va">grant_program</span>, <span class="va">grant_duration_text</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">grant_amount</span><span class="op">)</span>,
            avg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">grant_amount</span><span class="op">)</span>,
            number <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">bbc_year_size_duration</span>
<span class="co">## # A tibble: 21 × 6</span>
<span class="co">## # Groups:   grant_year, grant_program [8]</span>
<span class="co">##    grant_year grant_program grant_duration_text    total    avg number</span>
<span class="co">##         &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;                  &lt;dbl&gt;  &lt;dbl&gt;  &lt;int&gt;</span>
<span class="co">##  1       2016 Main Grants   2 years                97355 48678.      2</span>
<span class="co">##  2       2016 Main Grants   3 years             16308231 86746.    188</span>
<span class="co">##  3       2016 Small Grants  3 years               884902 28545.     31</span>
<span class="co">##  4       2017 Main Grants   1 year                 59586 29793       2</span>
<span class="co">##  5       2017 Main Grants   2 years               825732 82573.     10</span>
<span class="co">##  6       2017 Main Grants   3 years             47617605 90528.    526</span>
<span class="co">##  7       2017 Small Grants  1 year                 10000 10000       1</span>
<span class="co">##  8       2017 Small Grants  2 years               245227 18864.     13</span>
<span class="co">##  9       2017 Small Grants  3 years             13636128 27716.    492</span>
<span class="co">## 10       2018 Main Grants   1 year                118134 59067       2</span>
<span class="co">## # … with 11 more rows</span></code></pre></div>
<p>Next, we’ll fill by grant program and facet by duration and show the total number of grants awarded</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bbc_year_size_duration</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">grant_year</span>, y <span class="op">=</span> <span class="va">number</span>, fill <span class="op">=</span> <span class="va">grant_program</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>preserve <span class="op">=</span> <span class="st">"single"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">grant_duration_text</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/plot-year-size-duration-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>The vast majority of BBC Children in Need’s grants last for 3 years. Super neat.</p>
</div>
</div>
<div id="amounts-and-proportions" class="section level2" number="2.13">
<h2>
<span class="header-section-number">2.13</span> Amounts and proportions<a class="anchor" aria-label="anchor" href="#amounts-and-proportions"><i class="fas fa-link"></i></a>
</h2>
<p>For this example, we’re going to use real world data to demonstrate some different ways to visualize amounts and proportions. We’ll use data from the CDC and the Social Security Administration about the number of daily births in the United States from 1994–2014. <a href="https://fivethirtyeight.com/features/some-people-are-too-superstitious-to-have-a-baby-on-friday-the-13th/">FiveThirtyEight reported a story using this data in 2016</a> and they posted relatively CSV files <a href="https://github.com/fivethirtyeight/data/tree/master/births">on GitHub</a>, so we can download and use those.</p>
<p>If you want to follow along with this example, you can download the data directly from <a href="https://github.com/fivethirtyeight/data/tree/master/births">GitHub</a> or by using these links (you’ll likely need to right click on these and choose “Save Link As…”):</p>
<ul>
<li><a href="https://raw.githubusercontent.com/fivethirtyeight/data/master/births/US_births_1994-2003_CDC_NCHS.csv"><code>US_births_1994-2003_CDC_NCHS.csv</code></a></li>
<li><a href="https://raw.githubusercontent.com/fivethirtyeight/data/master/births/US_births_2000-2014_SSA.csv"><code>US_births_2000-2014_SSA.csv</code></a></li>
</ul>
<div id="load-data" class="section level3" number="2.13.1">
<h3>
<span class="header-section-number">2.13.1</span> Load data<a class="anchor" aria-label="anchor" href="#load-data"><i class="fas fa-link"></i></a>
</h3>
<p>There are two CSV files:</p>
<ul>
<li>
<code>US_births_1994-2003_CDC_NCHS.csv</code> contains U.S. births data for the years 1994 to 2003, as provided by the Centers for Disease Control and Prevention’s National Center for Health Statistics.</li>
<li>
<code>US_births_2000-2014_SSA.csv</code> contains U.S. births data for the years 2000 to 2014, as provided by the Social Security Administration.</li>
</ul>
<p>Since the two datasets overlap in 2000–2003, we use Social Security Administration data for those years.</p>
<p>We downloaded the data from GitHub and placed the CSV files in a folder named <code>data</code>. We’ll then load them with <code><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv()</a></code> and combine them into one data frame.</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org">scales</a></span><span class="op">)</span>   <span class="co"># For nice labels in charts</span>
<span class="va">births_1994_1999</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/US_births_1994-2003_CDC_NCHS.csv"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="co"># Ignore anything after 2000</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&lt;</span> <span class="fl">2000</span><span class="op">)</span>
<span class="va">births_2000_2014</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/US_births_2000-2014_SSA.csv"</span><span class="op">)</span>
<span class="va">births_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="va">births_1994_1999</span>, <span class="va">births_2000_2014</span><span class="op">)</span></code></pre></div>
</div>
<div id="wrangle-data" class="section level3" number="2.13.2">
<h3>
<span class="header-section-number">2.13.2</span> Wrangle data<a class="anchor" aria-label="anchor" href="#wrangle-data"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s look at the first few rows of the data to see what we’re working with:</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">births_combined</span>
<span class="co">## # A tibble: 7,670 × 5</span>
<span class="co">##     year month date_of_month day_of_week births</span>
<span class="co">##    &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">##  1  1994     1             1           6   8096</span>
<span class="co">##  2  1994     1             2           7   7772</span>
<span class="co">##  3  1994     1             3           1  10142</span>
<span class="co">##  4  1994     1             4           2  11248</span>
<span class="co">##  5  1994     1             5           3  11053</span>
<span class="co">##  6  1994     1             6           4  11406</span>
<span class="co">##  7  1994     1             7           5  11251</span>
<span class="co">##  8  1994     1             8           6   8653</span>
<span class="co">##  9  1994     1             9           7   7910</span>
<span class="co">## 10  1994     1            10           1  10498</span>
<span class="co">## # … with 7,660 more rows</span></code></pre></div>
<p>The columns for year and births seem straightforward and ready to use. The columns for month and day of the week could be improved if we changed them to text (i.e. January instead of 1; Tuesday instead of 3). To fix this, we can convert these columns to categorical variables, or factors in R. We can also specify that these categories (or factors) are ordered, meaning that Feburary comes after January, etc. Without ordering, R will plot them alphabetically, which isn’t very helpful.</p>
<p>We’ll make a new dataset named <code>births</code> that’s based on the combined births data, but with some new columns added:</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># The c() function lets us make a list of values</span>
<span class="va">month_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>, <span class="st">"May"</span>, <span class="st">"June"</span>, <span class="st">"July"</span>,
                 <span class="st">"August"</span>, <span class="st">"September"</span>, <span class="st">"October"</span>, <span class="st">"November"</span>, <span class="st">"December"</span><span class="op">)</span>

<span class="va">day_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, 
               <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>, <span class="st">"Saturday"</span>, <span class="st">"Sunday"</span><span class="op">)</span>

<span class="va">births</span> <span class="op">&lt;-</span> <span class="va">births_combined</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="co"># Make month an ordered factor, using the month_name list as labels</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">month</span>, labels <span class="op">=</span> <span class="va">month_names</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>day_of_week <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">day_of_week</span>, labels <span class="op">=</span> <span class="va">day_names</span>, ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
         date_of_month_categorical <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">date_of_month</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="co"># Add a column indicating if the day is on a weekend</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>weekend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">day_of_week</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Saturday"</span>, <span class="st">"Sunday"</span><span class="op">)</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">births</span><span class="op">)</span>
<span class="co">## # A tibble: 6 × 7</span>
<span class="co">##    year month   date_of_month day_of_week births date_of_month_categori… weekend</span>
<span class="co">##   &lt;dbl&gt; &lt;ord&gt;           &lt;dbl&gt; &lt;ord&gt;        &lt;dbl&gt; &lt;fct&gt;                   &lt;lgl&gt;  </span>
<span class="co">## 1  1994 January             1 Saturday      8096 1                       TRUE   </span>
<span class="co">## 2  1994 January             2 Sunday        7772 2                       TRUE   </span>
<span class="co">## 3  1994 January             3 Monday       10142 3                       FALSE  </span>
<span class="co">## 4  1994 January             4 Tuesday      11248 4                       FALSE  </span>
<span class="co">## 5  1994 January             5 Wednesday    11053 5                       FALSE  </span>
<span class="co">## 6  1994 January             6 Thursday     11406 6                       FALSE</span></code></pre></div>
<p>If you look at the data now, you can see the columns are changed and have different types. <code>year</code> and <code>date_of_month</code> are still numbers, but <code>month</code>, and <code>day_of_week</code> are ordered factors (<code>ord</code>) and <code>date_of_month_categorical</code> is a regular factor (<code>fct</code>). Technically it’s also ordered, but because it’s already alphabetical (i.e. 2 naturally comes after 1), we don’t need to force it to be in the right order.</p>
<p>Our <code>births</code> data is now clean and ready to go!</p>
</div>
<div id="bar-plot" class="section level3" number="2.13.3">
<h3>
<span class="header-section-number">2.13.3</span> Bar plot<a class="anchor" aria-label="anchor" href="#bar-plot"><i class="fas fa-link"></i></a>
</h3>
<p>First we can look at a bar chart showing the total number of births each day. We need to make a smaller summarized dataset and then we’ll plot it:</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">total_births_weekday</span> <span class="op">&lt;-</span> <span class="va">births</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">day_of_week</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">births</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">total_births_weekday</span>,
       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">day_of_week</span>, y <span class="op">=</span> <span class="va">total</span>, fill <span class="op">=</span> <span class="va">day_of_week</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Turn off the fill legend because it's redundant</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/plot-bar-chart-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>If we fill by day of the week, we get 7 different colors, which is fine (I guess), but doesn’t really help tell a story. The main story here is that there are far fewer births during weekends. If we create a new column that flags if a row is Saturday or Sunday, we can fill by that column instead:</p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">total_births_weekday</span> <span class="op">&lt;-</span> <span class="va">births</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">day_of_week</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">births</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>weekend <span class="op">=</span> <span class="va">day_of_week</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Saturday"</span>, <span class="st">"Sunday"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">total_births_weekday</span>,
       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">day_of_week</span>, y <span class="op">=</span> <span class="va">total</span>, fill <span class="op">=</span> <span class="va">weekend</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/plot-bar-chart-weekend-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Neat! Those default colors are kinda ugly, though, so let’s use the principles of preattentive processing and contrast to highlight the weekend bars:</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">total_births_weekday</span>,
       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">day_of_week</span>, y <span class="op">=</span> <span class="va">total</span>, fill <span class="op">=</span> <span class="va">weekend</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Use grey and orange</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grey70"</span>, <span class="st">"#f2ad22"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Use commas instead of scientific notation</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">comma</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Turn off the legend since the title shows what the orange is</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Weekends are unpopular times for giving birth"</span>,
       x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"Total births"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/plot-bar-chart-weekend-better-1.png" width="80%" style="display: block; margin: auto;"></div>
</div>
<div id="lollipop-chart" class="section level3" number="2.13.4">
<h3>
<span class="header-section-number">2.13.4</span> Lollipop chart<a class="anchor" aria-label="anchor" href="#lollipop-chart"><i class="fas fa-link"></i></a>
</h3>
<p>Since the ends of the bars are often the most important part of the graph, we can use a lollipop chart to emphasize them. We’ll keep all the same code from our bar chart and make a few changes:</p>
<ul>
<li>Color by weekend instead of fill by weekend, since points and lines are colored in ggplot, not filled</li>
<li>Switch <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual()</a></code> to <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual()</a></code> and turn off the <code>color</code> legend in the <code><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides()</a></code> layer</li>
<li>Switch <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col()</a></code> to <code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_pointrange()</a></code>. The <code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_pointrange()</a></code> layer requires two additional aesthetics: <code>ymin</code> and <code>ymax</code> for the ends of the lines that come out of the point. Here we’ll set <code>ymin</code> to 0 so it starts at the x-axis, and we’ll set <code>ymax</code> to <code>total</code> so it ends at the point.</li>
</ul>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">total_births_weekday</span>,
       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">day_of_week</span>, y <span class="op">=</span> <span class="va">total</span>, color <span class="op">=</span> <span class="va">weekend</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_pointrange</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="va">total</span><span class="op">)</span>,
                  <span class="co"># Make the lines a little thicker and the dots a little bigger</span>
                  fatten <span class="op">=</span> <span class="fl">5</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Use grey and orange</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grey70"</span>, <span class="st">"#f2ad22"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Use commas instead of scientific notation</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">comma</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Turn off the legend since the title shows what the orange is</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Weekends are unpopular times for giving birth"</span>,
       x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"Total births"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/plot-lollipop-chart-weekend-better-1.png" width="80%" style="display: block; margin: auto;"></div>
</div>
<div id="strip-plot" class="section level3" number="2.13.5">
<h3>
<span class="header-section-number">2.13.5</span> Strip plot<a class="anchor" aria-label="anchor" href="#strip-plot"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s show all the data with points. We’ll use the full dataset now, map <code>x</code> to weekday, <code>y</code> to births, and change <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col()</a></code> to <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>. We’ll tell <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> to jitter the points randomly.</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">births</span>,
       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">day_of_week</span>, y <span class="op">=</span> <span class="va">births</span>, color <span class="op">=</span> <span class="va">weekend</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grey70"</span>, <span class="st">"#f2ad22"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.5</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/strip-plot-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>There are some interesting points in the low ends, likely because of holidays like Labor Day and Memorial Day (for the Mondays) and Thanksgiving (for the Thursday). If we had a column that indicated whether a day was a holiday, we could color by that and it would probably explain most of those low numbers. Unfortunately we don’t have that column, and it’d be hard to make. Some holidays are constant (Halloween is always October 31), but some aren’t (Thanksgiving is the fourth Thursday in November, so we’d need to find out which November 20-somethingth each year is the fourth Thursday, and good luck doing that at scale).</p>
</div>
<div id="beeswarm-plot" class="section level3" number="2.13.6">
<h3>
<span class="header-section-number">2.13.6</span> Beeswarm plot<a class="anchor" aria-label="anchor" href="#beeswarm-plot"><i class="fas fa-link"></i></a>
</h3>
<p>We can add some structure to these points if we use the <a href="https://github.com/eclarke/ggbeeswarm"><strong>ggbeeswarm</strong> package</a>, with either <code><a href="https://rdrr.io/pkg/ggbeeswarm/man/geom_beeswarm.html">geom_beeswarm()</a></code> or <code><a href="https://rdrr.io/pkg/ggbeeswarm/man/geom_quasirandom.html">geom_quasirandom()</a></code>. <code><a href="https://rdrr.io/pkg/ggbeeswarm/man/geom_quasirandom.html">geom_quasirandom()</a></code> actually works better here since there are so many points – <code><a href="https://rdrr.io/pkg/ggbeeswarm/man/geom_beeswarm.html">geom_beeswarm()</a></code> makes the clusters of points way too wide.</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/eclarke/ggbeeswarm">ggbeeswarm</a></span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">births</span>,
       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">day_of_week</span>, y <span class="op">=</span> <span class="va">births</span>, color <span class="op">=</span> <span class="va">weekend</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grey70"</span>, <span class="st">"#f2ad22"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Make these points suuuper tiny</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggbeeswarm/man/geom_quasirandom.html">geom_quasirandom</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.0001</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/beeswarm-plot-1.png" width="80%" style="display: block; margin: auto;"></div>
</div>
<div id="heatmap" class="section level3" number="2.13.7">
<h3>
<span class="header-section-number">2.13.7</span> Heatmap<a class="anchor" aria-label="anchor" href="#heatmap"><i class="fas fa-link"></i></a>
</h3>
<p>Finally, let’s use something non-traditional to show the average births by day in a somewhat proportional way. We can calculate the average number of births every day and then make a heatmap that fills each square by that average, thus showing the relative differences in births per day.</p>
<p>To do this, we need to make a summarized data frame with <code>group_by() %&gt;% summarize()</code> to calculate the average number of births by month and day of the month (i.e. average for January 1, January 2, etc.).</p>
<p>We’ll then make a sort of calendar with date of the month on the x axis, month on the y axis, with heat map squares filled by the daily average. We’ll use <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile()</a></code> to add squares for each day, and then add some extra scale, coordinates, and theme layers to clean up the plot:</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">avg_births_month_day</span> <span class="op">&lt;-</span> <span class="va">births</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">month</span>, <span class="va">date_of_month_categorical</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>avg_births <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">births</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">avg_births_month_day</span>,
       <span class="co"># By default, the y-axis will have December at the top, so use fct_rev() to reverse it</span>
       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date_of_month_categorical</span>, y <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html">fct_rev</a></span><span class="op">(</span><span class="va">month</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">avg_births</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Add viridis colors</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"inferno"</span>, labels <span class="op">=</span> <span class="va">comma</span><span class="op">)</span> <span class="op">+</span> 
  <span class="co"># Add nice labels</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Day of the month"</span>, y <span class="op">=</span> <span class="cn">NULL</span>,
       title <span class="op">=</span> <span class="st">"Average births per day"</span>,
       subtitle <span class="op">=</span> <span class="st">"1994-2014"</span>,
       fill <span class="op">=</span> <span class="st">"Average births"</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Force all the tiles to have equal widths and heights</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Use a cleaner theme</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/plot-heatmap-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Neat! There are some really interesting trends here. Most obvious, probably, is that very few people are born on New Year’s Day, July 4th, Halloween, Thanksgiving, and Christmas.</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">avg_births_month_day</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">avg_births</span><span class="op">)</span>
<span class="co">## # A tibble: 366 × 3</span>
<span class="co">## # Groups:   month [12]</span>
<span class="co">##    month    date_of_month_categorical avg_births</span>
<span class="co">##    &lt;ord&gt;    &lt;fct&gt;                          &lt;dbl&gt;</span>
<span class="co">##  1 December 25                             6601.</span>
<span class="co">##  2 January  1                              7827.</span>
<span class="co">##  3 December 24                             8103.</span>
<span class="co">##  4 July     4                              8825.</span>
<span class="co">##  5 January  2                              9356.</span>
<span class="co">##  6 December 26                             9599.</span>
<span class="co">##  7 November 27                             9770.</span>
<span class="co">##  8 November 23                             9919.</span>
<span class="co">##  9 November 25                            10001 </span>
<span class="co">## 10 October  31                            10030.</span>
<span class="co">## # … with 356 more rows</span></code></pre></div>
<p>The days with the highest average are in mid-September, likely because that’s about 9 months after the first week of January. July 7th at #7 is odd and I have no idea why it might be so popular.</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">avg_births_month_day</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">avg_births</span><span class="op">)</span><span class="op">)</span>
<span class="co">## # A tibble: 366 × 3</span>
<span class="co">## # Groups:   month [12]</span>
<span class="co">##    month     date_of_month_categorical avg_births</span>
<span class="co">##    &lt;ord&gt;     &lt;fct&gt;                          &lt;dbl&gt;</span>
<span class="co">##  1 September 9                             12344.</span>
<span class="co">##  2 September 19                            12285.</span>
<span class="co">##  3 September 12                            12282.</span>
<span class="co">##  4 September 17                            12201.</span>
<span class="co">##  5 September 10                            12190.</span>
<span class="co">##  6 September 20                            12162.</span>
<span class="co">##  7 July      7                             12147.</span>
<span class="co">##  8 September 15                            12126.</span>
<span class="co">##  9 September 16                            12114.</span>
<span class="co">## 10 September 18                            12112.</span>
<span class="co">## # … with 356 more rows</span></code></pre></div>
<p>The funniest trend is the very visible dark column for the 13th of every month. People <em>really</em> don’t want to give birth on the 13th.</p>
</div>
</div>
<div id="comparisons" class="section level2" number="2.14">
<h2>
<span class="header-section-number">2.14</span> Comparisons<a class="anchor" aria-label="anchor" href="#comparisons"><i class="fas fa-link"></i></a>
</h2>
<p>For this example, we’re going to use cross-national data, but instead of using the typical <code>gapminder</code> dataset, we’re going to collect data directly from the <a href="https://data.worldbank.org/">World Bank’s Open Data portal</a></p>
<p>If you want to skip the data downloading, you can download the data below (you’ll likely need to right click and choose “Save Link As…”):</p>
<ul>
<li><a href="https://data-mining-viz.netlify.app/data/wdi_raw.csv"><code>wdi_raw.csv</code></a></li>
</ul>
<div id="load-and-clean-data-1" class="section level3" number="2.14.1">
<h3>
<span class="header-section-number">2.14.1</span> Load and clean data<a class="anchor" aria-label="anchor" href="#load-and-clean-data-1"><i class="fas fa-link"></i></a>
</h3>
<p>First, we load the libraries we’ll be using:</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>  <span class="co"># For ggplot, dplyr, and friends</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://vincentarelbundock.github.io/WDI/">WDI</a></span><span class="op">)</span>        <span class="co"># For getting data from the World Bank</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hafen/geofacet">geofacet</a></span><span class="op">)</span>   <span class="co"># For map-shaped facets</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org">scales</a></span><span class="op">)</span>     <span class="co"># For helpful scale functions like dollar()</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slowkow/ggrepel">ggrepel</a></span><span class="op">)</span>    <span class="co"># For non-overlapping labels</span></code></pre></div>
<p>The World Bank has a ton of country-level data at <a href="https://data.worldbank.org/">data.worldbank.org</a>. We can use <a href="https://cran.r-project.org/package=WDI">a package named <strong>WDI</strong></a> (<strong>w</strong>orld <strong>d</strong>evelopment <strong>i</strong>ndicators) to access their servers and download the data directly into R.</p>
<p>To do this, we need to find the special World Bank codes for specific variables we want to get. These codes come from the URLs of the World Bank’s website. For instance, if you search for “access to electricity” at the World Bank’s website, you’ll find <a href="https://data.worldbank.org/indicator/EG.ELC.ACCS.ZS">this page</a>. If you look at the end of the URL, you’ll see a cryptic code: <code>EG.ELC.ACCS.ZS</code>. That’s the World Bank’s ID code for the “Access to electricity (% of population)” indicator.</p>
<p>We can feed a list of ID codes to the <code><a href="https://vincentarelbundock.github.io/WDI/reference/WDI.html">WDI()</a></code> function to download data for those specific indicators. We want data from 1995-2015, so we set the start and end years accordingly. The <code>extra=TRUE</code> argument means that it’ll also include other helpful details like region, aid status, etc. Without it, it would only download the indicators we listed.</p>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">indicators</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SP.DYN.LE00.IN"</span>,  <span class="co"># Life expectancy</span>
                <span class="st">"EG.ELC.ACCS.ZS"</span>,  <span class="co"># Access to electricity</span>
                <span class="st">"EN.ATM.CO2E.PC"</span>,  <span class="co"># CO2 emissions</span>
                <span class="st">"NY.GDP.PCAP.KD"</span><span class="op">)</span>  <span class="co"># GDP per capita</span>

<span class="va">wdi_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://vincentarelbundock.github.io/WDI/reference/WDI.html">WDI</a></span><span class="op">(</span>country <span class="op">=</span> <span class="st">"all"</span>, <span class="va">indicators</span>, extra <span class="op">=</span> <span class="cn">TRUE</span>, 
               start <span class="op">=</span> <span class="fl">1995</span>, end <span class="op">=</span> <span class="fl">2015</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">wdi_raw</span><span class="op">)</span></code></pre></div>
<p>Downloading data from the World Bank every time you knit will get tedious and take a long time (plus if their servers are temporarily down, you won’t be able to get the data). It’s good practice to save this raw data as a CSV file and then work with that.</p>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span><span class="va">wdi_raw</span>, <span class="st">"data/wdi_raw.csv"</span><span class="op">)</span></code></pre></div>
<p>Then we clean up the data a little, filtering out rows that aren’t actually countries and renaming the ugly World Bank code columns to actual words:</p>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">wdi_clean</span> <span class="op">&lt;-</span> <span class="va">wdi_raw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">region</span> <span class="op">!=</span> <span class="st">"Aggregates"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">iso2c</span>, <span class="va">country</span>, <span class="va">year</span>, 
         life_expectancy <span class="op">=</span> <span class="va">SP.DYN.LE00.IN</span>, 
         access_to_electricity <span class="op">=</span> <span class="va">EG.ELC.ACCS.ZS</span>, 
         co2_emissions <span class="op">=</span> <span class="va">EN.ATM.CO2E.PC</span>, 
         gdp_per_cap <span class="op">=</span> <span class="va">NY.GDP.PCAP.KD</span>, 
         <span class="va">region</span>, <span class="va">income</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">wdi_clean</span><span class="op">)</span>
<span class="co">## # A tibble: 6 × 9</span>
<span class="co">##   iso2c country  year life_expectancy access_to_elect… co2_emissions gdp_per_cap</span>
<span class="co">##   &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;</span>
<span class="co">## 1 AD    Andorra  2015              NA              100         NA         41768.</span>
<span class="co">## 2 AD    Andorra  2004              NA              100          7.36      47033.</span>
<span class="co">## 3 AD    Andorra  2001              NA              100          7.79      41421.</span>
<span class="co">## 4 AD    Andorra  2002              NA              100          7.59      42396.</span>
<span class="co">## 5 AD    Andorra  2014              NA              100          5.83      40790.</span>
<span class="co">## 6 AD    Andorra  1995              NA              100          6.66      32918.</span>
<span class="co">## # … with 2 more variables: region &lt;chr&gt;, income &lt;chr&gt;</span></code></pre></div>
</div>
<div id="small-multiples" class="section level3" number="2.14.2">
<h3>
<span class="header-section-number">2.14.2</span> Small multiples<a class="anchor" aria-label="anchor" href="#small-multiples"><i class="fas fa-link"></i></a>
</h3>
<p>First we can make some small multiples plots and show life expectancy over time for a handful of countries. We’ll make a list of some countries chosen at random while I scrolled through the data, and then filter our data to include only those rows. We then plot life expectancy, faceting by country.</p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">life_expectancy_small</span> <span class="op">&lt;-</span> <span class="va">wdi_clean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Afghanistan"</span>, <span class="st">"Belarus"</span>, <span class="st">"India"</span>,
                        <span class="st">"Mexico"</span>, <span class="st">"New Zealand"</span>, <span class="st">"Spain"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">life_expectancy_small</span>, 
       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">life_expectancy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/life-expectancy-small-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Small multiples! That’s all we need to do.</p>
<p>We can do some fancier things, though. We can make this plot hyper minimalist:</p>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">life_expectancy_small</span>, 
       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">life_expectancy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/life-expectancy-small-minimalist-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>We can do a whole part of a continent (poor Iraq and Syria)</p>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">life_expectancy_mena</span> <span class="op">&lt;-</span> <span class="va">wdi_clean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">region</span> <span class="op">==</span> <span class="st">"Middle East &amp; North Africa"</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">life_expectancy_mena</span>, 
       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">life_expectancy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/life-expectancy-mena-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>We can use the <a href="https://hafen.github.io/geofacet/"><strong>geofacet</strong> package</a> to arrange these facets by geography:</p>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">life_expectancy_eu</span> <span class="op">&lt;-</span> <span class="va">wdi_clean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">region</span> <span class="op">==</span> <span class="st">"Europe &amp; Central Asia"</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">life_expectancy_eu</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">life_expectancy</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/geofacet/man/facet_geo.html">facet_geo</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span>, grid <span class="op">=</span> <span class="st">"eu_grid1"</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span>, title <span class="op">=</span> <span class="st">"Life expectancy from 1995–2015"</span>,
       caption <span class="op">=</span> <span class="st">"Source: The World Bank (SP.DYN.LE00.IN)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,
        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,
        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/life-expectancy-eu-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Neat!</p>
</div>
<div id="sparklines" class="section level3" number="2.14.3">
<h3>
<span class="header-section-number">2.14.3</span> Sparklines<a class="anchor" aria-label="anchor" href="#sparklines"><i class="fas fa-link"></i></a>
</h3>
<p>Sparklines are just line charts (or bar charts) that are really really small.</p>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">india_co2</span> <span class="op">&lt;-</span> <span class="va">wdi_clean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op">==</span> <span class="st">"India"</span><span class="op">)</span>

<span class="va">plot_india</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">india_co2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">co2_emissions</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">plot_india</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/india-spark-1.png" width="96" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"india_co2.pdf"</span>, <span class="va">plot_india</span>, width <span class="op">=</span> <span class="fl">1</span>, height <span class="op">=</span> <span class="fl">0.15</span>, units <span class="op">=</span> <span class="st">"in"</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"india_co2.png"</span>, <span class="va">plot_india</span>, width <span class="op">=</span> <span class="fl">1</span>, height <span class="op">=</span> <span class="fl">0.15</span>, units <span class="op">=</span> <span class="st">"in"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">china_co2</span> <span class="op">&lt;-</span> <span class="va">wdi_clean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op">==</span> <span class="st">"China"</span><span class="op">)</span>

<span class="va">plot_china</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">china_co2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">co2_emissions</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">plot_china</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/china-spark-1.png" width="96" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"china_co2.pdf"</span>, <span class="va">plot_china</span>, width <span class="op">=</span> <span class="fl">1</span>, height <span class="op">=</span> <span class="fl">0.15</span>, units <span class="op">=</span> <span class="st">"in"</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"china_co2.png"</span>, <span class="va">plot_china</span>, width <span class="op">=</span> <span class="fl">1</span>, height <span class="op">=</span> <span class="fl">0.15</span>, units <span class="op">=</span> <span class="st">"in"</span><span class="op">)</span></code></pre></div>
<p>You can then use those saved tiny plots in your text.</p>
<blockquote>
<p>Both India <img class="img-inline" src="https://data-mining-viz.netlify.app/images/india-spark-1.png" width="100"> and China <img class="img-inline" src="https://data-mining-viz.netlify.app/images/china-spark-1.png" width="100"> have seen increased CO<sub>2</sub> emissions over the past 20 years.</p>
</blockquote>
</div>
<div id="slopegraphs" class="section level3" number="2.14.4">
<h3>
<span class="header-section-number">2.14.4</span> Slopegraphs<a class="anchor" aria-label="anchor" href="#slopegraphs"><i class="fas fa-link"></i></a>
</h3>
<p>We can make a slopegraph to show changes in GDP per capita between two time periods. We need to first filter our WDI to include only the start and end years (here 1995 and 2015). Then, to make sure that we’re using complete data, we’ll get rid of any country that has missing data for either 1995 or 2015. The <code>group_by(...) %&gt;% filter(...) %&gt;% ungroup()</code> pipeline does this, with the <code>!any(is.na(gdp_per_cap))</code> test keeping any rows where any of the <code>gdp_per_cap</code> values are not missing for the whole country.</p>
<p>We then add a couple special columns for labels. The <code><a href="https://rdrr.io/r/base/paste.html">paste0()</a></code> function concatenates strings and variables together, so that <code>paste0("2 + 2 = ", 2 + 2)</code> would show “2 + 2 = 4”. Here we make labels that say either “Country name: $GDP” or “$GDP” depending on the year.</p>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gdp_south_asia</span> <span class="op">&lt;-</span> <span class="va">wdi_clean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">region</span> <span class="op">==</span> <span class="st">"South Asia"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1995</span>, <span class="fl">2015</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="co"># Look at each country individually</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">country</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="co"># Remove the country if any of its gdp_per_cap values are missing</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">gdp_per_cap</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="co"># Make year a factor</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="co"># Make some nice label columns</span>
  <span class="co"># If the year is 1995, format it like "Country name: $GDP". If the year is</span>
  <span class="co"># 2015, format it like "$GDP"</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>label_first <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fl">1995</span>, <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="va">country</span>, <span class="st">": "</span>, <span class="fu"><a href="https://scales.r-lib.org/reference/label_dollar.html">dollar</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">gdp_per_cap</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span>,
         label_last <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2015</span>, <span class="fu"><a href="https://scales.r-lib.org/reference/label_dollar.html">dollar</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">gdp_per_cap</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>With the data filtered like this, we can plot it by mapping year to the x-axis, GDP per capita to the y-axis, and coloring by country. To make the lines go across the two categorical labels in the x-axis (since we made year a factor/category), we need to also specify the <code>group</code> aesthetic.</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">gdp_south_asia</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">gdp_per_cap</span>, group <span class="op">=</span> <span class="va">country</span>, color <span class="op">=</span> <span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/slopegraph-sa-simple-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Cool! We’re getting closer. We can definitely see different slopes, but with 7 different colors, it’s hard to see exactly which country is which. Instead, we can directly label each of these lines with <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code>:</p>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">gdp_south_asia</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">gdp_per_cap</span>, group <span class="op">=</span> <span class="va">country</span>, color <span class="op">=</span> <span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/slopegraph-sa-simple-text-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>That gets us a <em>little</em> closer, but the country labels are hard to see, and we could include more information, like the actual values. Remember those <code>label_first</code> and <code>label_last</code> columns we made? Let’s use those instead:</p>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">gdp_south_asia</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">gdp_per_cap</span>, group <span class="op">=</span> <span class="va">country</span>, color <span class="op">=</span> <span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label_first</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label_last</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/slopegraph-sa-simple-text-fancier-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Now we have dollar amounts and country names, but the labels are still overlapping and really hard to read. To fix this, we can make the labels repel away from each other and randomly position in a way that makes them not overlap. The <a href="https://cran.r-project.org/web/packages/ggrepel/vignettes/ggrepel.html"><strong>ggrepel</strong> package</a> lets us do this with <code><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel()</a></code></p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">gdp_south_asia</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">gdp_per_cap</span>, group <span class="op">=</span> <span class="va">country</span>, color <span class="op">=</span> <span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label_first</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label_last</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/slopegraph-sa-getting-warmer-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Now none of the labels are on top of each other, but the labels are still on top of the lines. Also, some of the labels moved inward and outward along the x-axis, but they don’t need to do that—they just need to shift up and down. We can force the labels to only move up and down by setting the <code>direction = "y"</code> argument, and we can move all the labels to the left or right with the <code>nudge_x</code> argument. The <code>seed</code> argument makes sure that the random label placement is the same every time we run this. It can be whatever number you want—it just has to be a number.</p>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">gdp_south_asia</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">gdp_per_cap</span>, group <span class="op">=</span> <span class="va">country</span>, color <span class="op">=</span> <span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label_first</span><span class="op">)</span>, direction <span class="op">=</span> <span class="st">"y"</span>, nudge_x <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, seed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label_last</span><span class="op">)</span>, direction <span class="op">=</span> <span class="st">"y"</span>, nudge_x <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/slopegraph-sa-fancier-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>That’s it! Let’s take the theme off completely, change the colors a little, and it should be perfect.</p>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">gdp_south_asia</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">gdp_per_cap</span>, group <span class="op">=</span> <span class="va">country</span>, color <span class="op">=</span> <span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label_first</span><span class="op">)</span>, direction <span class="op">=</span> <span class="st">"y"</span>, nudge_x <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, seed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label_last</span><span class="op">)</span>, direction <span class="op">=</span> <span class="st">"y"</span>, nudge_x <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"magma"</span>, end <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/slopegraph-sa-done-1.png" width="80%" style="display: block; margin: auto;"></div>
</div>
<div id="bump-charts" class="section level3" number="2.14.5">
<h3>
<span class="header-section-number">2.14.5</span> Bump charts<a class="anchor" aria-label="anchor" href="#bump-charts"><i class="fas fa-link"></i></a>
</h3>
<p>Finally, we can make a bump chart that shows changes in rankings over time. We’ll look at CO<sub>2</sub> emissions in South Asia. First we need to calculate a new variable that shows the rank of each country within each year. We can do this if we group by year and then use the <code><a href="https://rdrr.io/r/base/rank.html">rank()</a></code> function to rank countries by the <code>co2_emissions</code> column.</p>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sa_co2</span> <span class="op">&lt;-</span> <span class="va">wdi_clean</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">region</span> <span class="op">==</span> <span class="st">"South Asia"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">&gt;=</span> <span class="fl">2004</span>, <span class="va">year</span> <span class="op">&lt;</span> <span class="fl">2015</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="va">co2_emissions</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>We then plot this with points and lines, reversing the y-axis so 1 is at the top:</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">sa_co2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">rank</span>, color <span class="op">=</span> <span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_reverse</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/make-bump-plot-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Afghanistan and Nepal switched around for the number 1 spot, while India dropped from 4 to 6, switching places with Pakistan.</p>
<p>As with the slopegraph, there are 8 different colors in the legend and it’s hard to line them all up with the different lines, so we can plot the text directly instead. We’ll use <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code> again. We don’t need to repel anything, since the text should fit in each row just fine. We need to change the <code>data</code> argument in <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code> though and filter the data to only include one year, otherwise we’ll get labels on every point, which is excessive. We can also adjust the theme and colors to make it cleaner.</p>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">sa_co2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">rank</span>, color <span class="op">=</span> <span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">sa_co2</span>, <span class="va">year</span> <span class="op">==</span> <span class="fl">2004</span><span class="op">)</span>,
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">iso2c</span>, x <span class="op">=</span> <span class="fl">2003.25</span><span class="op">)</span>,
            fontface <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">sa_co2</span>, <span class="va">year</span> <span class="op">==</span> <span class="fl">2014</span><span class="op">)</span>,
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">iso2c</span>, x <span class="op">=</span> <span class="fl">2014.75</span><span class="op">)</span>,
            fontface <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_reverse</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">2004</span><span class="op">:</span><span class="fl">2014</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_color_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"magma"</span>, begin <span class="op">=</span> <span class="fl">0.2</span>, end <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"Rank"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.major.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        panel.grid.minor.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        panel.grid.minor.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="02-showing-numbers-customization_files/figure-html/bump-plot-fancier-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>If you want to be <em>super</em> fancy, you can use flags instead of country codes, but that’s a little more complicated (you need to install the <a href="https://github.com/rensa/ggflags"><strong>ggflags</strong> package</a>. <a href="https://dominikkoch.github.io/Bump-Chart/">See here for an example</a>.</p>
</div>
</div>
<div id="acknowledgments" class="section level2 unnumbered">
<h2>Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Coding examples from <a href="https://datavizm20.classes.andrewheiss.com">Andrew Heiss</a>
</li>
</ul>
</div>
<div id="session-info-1" class="section level2 unnumbered">
<h2>Session info<a class="anchor" aria-label="anchor" href="#session-info-1"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html">session_info</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">## ─ Session info ───────────────────────────────────────────────────────────────</span>
<span class="co">##  setting  value</span>
<span class="co">##  version  R version 4.1.2 (2021-11-01)</span>
<span class="co">##  os       macOS Monterey 12.2.1</span>
<span class="co">##  system   aarch64, darwin20</span>
<span class="co">##  ui       X11</span>
<span class="co">##  language (EN)</span>
<span class="co">##  collate  en_US.UTF-8</span>
<span class="co">##  ctype    en_US.UTF-8</span>
<span class="co">##  tz       America/Chicago</span>
<span class="co">##  date     2022-03-04</span>
<span class="co">##  pandoc   2.17.1.1 @ /Applications/RStudio.app/Contents/MacOS/quarto/bin/ (via rmarkdown)</span>
<span class="co">## </span>
<span class="co">## ─ Packages ───────────────────────────────────────────────────────────────────</span>
<span class="co">##  package       * version date (UTC) lib source</span>
<span class="co">##  assertthat      0.2.1   2019-03-21 [1] CRAN (R 4.1.0)</span>
<span class="co">##  backports       1.4.1   2021-12-13 [1] CRAN (R 4.1.1)</span>
<span class="co">##  beeswarm        0.4.0   2021-06-01 [1] CRAN (R 4.1.0)</span>
<span class="co">##  bit             4.0.4   2020-08-04 [1] CRAN (R 4.1.1)</span>
<span class="co">##  bit64           4.0.5   2020-08-30 [1] CRAN (R 4.1.0)</span>
<span class="co">##  bookdown        0.24    2021-09-02 [1] CRAN (R 4.1.1)</span>
<span class="co">##  brio            1.1.3   2021-11-30 [1] CRAN (R 4.1.1)</span>
<span class="co">##  broom         * 0.7.12  2022-01-28 [1] CRAN (R 4.1.1)</span>
<span class="co">##  bslib           0.3.1   2021-10-06 [1] CRAN (R 4.1.1)</span>
<span class="co">##  cachem          1.0.6   2021-08-19 [1] CRAN (R 4.1.1)</span>
<span class="co">##  callr           3.7.0   2021-04-20 [1] CRAN (R 4.1.0)</span>
<span class="co">##  cellranger      1.1.0   2016-07-27 [1] CRAN (R 4.1.0)</span>
<span class="co">##  class           7.3-20  2022-01-13 [1] CRAN (R 4.1.1)</span>
<span class="co">##  classInt        0.4-3   2020-04-07 [1] CRAN (R 4.1.0)</span>
<span class="co">##  cli             3.2.0   2022-02-14 [1] CRAN (R 4.1.1)</span>
<span class="co">##  codetools       0.2-18  2020-11-04 [1] CRAN (R 4.1.2)</span>
<span class="co">##  colorspace      2.0-3   2022-02-21 [1] CRAN (R 4.1.1)</span>
<span class="co">##  crayon          1.5.0   2022-02-14 [1] CRAN (R 4.1.1)</span>
<span class="co">##  DBI             1.1.2   2021-12-20 [1] CRAN (R 4.1.1)</span>
<span class="co">##  dbplyr          2.1.1   2021-04-06 [1] CRAN (R 4.1.0)</span>
<span class="co">##  desc            1.4.0   2021-09-28 [1] CRAN (R 4.1.1)</span>
<span class="co">##  devtools        2.4.3   2021-11-30 [1] CRAN (R 4.1.1)</span>
<span class="co">##  digest          0.6.29  2021-12-01 [1] CRAN (R 4.1.1)</span>
<span class="co">##  dplyr         * 1.0.8   2022-02-08 [1] CRAN (R 4.1.1)</span>
<span class="co">##  e1071           1.7-9   2021-09-16 [1] CRAN (R 4.1.1)</span>
<span class="co">##  ellipsis        0.3.2   2021-04-29 [1] CRAN (R 4.1.0)</span>
<span class="co">##  evaluate        0.15    2022-02-18 [1] CRAN (R 4.1.1)</span>
<span class="co">##  fansi           1.0.2   2022-01-14 [1] CRAN (R 4.1.1)</span>
<span class="co">##  farver          2.1.0   2021-02-28 [1] CRAN (R 4.1.0)</span>
<span class="co">##  fastmap         1.1.0   2021-01-25 [1] CRAN (R 4.1.0)</span>
<span class="co">##  forcats       * 0.5.1   2021-01-27 [1] CRAN (R 4.1.1)</span>
<span class="co">##  fs              1.5.2   2021-12-08 [1] CRAN (R 4.1.1)</span>
<span class="co">##  gapminder     * 0.3.0   2017-10-31 [1] CRAN (R 4.1.0)</span>
<span class="co">##  generics        0.1.2   2022-01-31 [1] CRAN (R 4.1.1)</span>
<span class="co">##  geofacet      * 0.2.0   2020-05-26 [1] CRAN (R 4.1.1)</span>
<span class="co">##  geogrid         0.1.1   2018-12-11 [1] CRAN (R 4.1.0)</span>
<span class="co">##  ggbeeswarm    * 0.6.0   2017-08-07 [1] CRAN (R 4.1.0)</span>
<span class="co">##  ggplot2       * 3.3.5   2021-06-25 [1] CRAN (R 4.1.1)</span>
<span class="co">##  ggrepel       * 0.9.1   2021-01-15 [1] CRAN (R 4.1.1)</span>
<span class="co">##  glue            1.6.1   2022-01-22 [1] CRAN (R 4.1.1)</span>
<span class="co">##  gridExtra       2.3     2017-09-09 [1] CRAN (R 4.1.1)</span>
<span class="co">##  gtable          0.3.0   2019-03-25 [1] CRAN (R 4.1.1)</span>
<span class="co">##  haven           2.4.3   2021-08-04 [1] CRAN (R 4.1.1)</span>
<span class="co">##  here          * 1.0.1   2020-12-13 [1] CRAN (R 4.1.0)</span>
<span class="co">##  highr           0.9     2021-04-16 [1] CRAN (R 4.1.0)</span>
<span class="co">##  hms             1.1.1   2021-09-26 [1] CRAN (R 4.1.1)</span>
<span class="co">##  htmltools       0.5.2   2021-08-25 [1] CRAN (R 4.1.1)</span>
<span class="co">##  httr            1.4.2   2020-07-20 [1] CRAN (R 4.1.0)</span>
<span class="co">##  imguR           1.0.3   2016-03-29 [1] CRAN (R 4.1.0)</span>
<span class="co">##  jpeg            0.1-9   2021-07-24 [1] CRAN (R 4.1.0)</span>
<span class="co">##  jquerylib       0.1.4   2021-04-26 [1] CRAN (R 4.1.0)</span>
<span class="co">##  jsonlite        1.8.0   2022-02-22 [1] CRAN (R 4.1.1)</span>
<span class="co">##  KernSmooth      2.23-20 2021-05-03 [1] CRAN (R 4.1.2)</span>
<span class="co">##  knitr         * 1.37    2021-12-16 [1] CRAN (R 4.1.1)</span>
<span class="co">##  labeling        0.4.2   2020-10-20 [1] CRAN (R 4.1.0)</span>
<span class="co">##  lattice         0.20-45 2021-09-22 [1] CRAN (R 4.1.2)</span>
<span class="co">##  lifecycle       1.0.1   2021-09-24 [1] CRAN (R 4.1.1)</span>
<span class="co">##  lubridate     * 1.8.0   2021-10-07 [1] CRAN (R 4.1.1)</span>
<span class="co">##  magrittr        2.0.2   2022-01-26 [1] CRAN (R 4.1.1)</span>
<span class="co">##  Matrix          1.4-0   2021-12-08 [1] CRAN (R 4.1.1)</span>
<span class="co">##  memoise         2.0.1   2021-11-26 [1] CRAN (R 4.1.1)</span>
<span class="co">##  mgcv            1.8-38  2021-10-06 [1] CRAN (R 4.1.1)</span>
<span class="co">##  modelr          0.1.8   2020-05-19 [1] CRAN (R 4.1.0)</span>
<span class="co">##  munsell         0.5.0   2018-06-12 [1] CRAN (R 4.1.0)</span>
<span class="co">##  nlme            3.1-155 2022-01-13 [1] CRAN (R 4.1.1)</span>
<span class="co">##  pillar          1.7.0   2022-02-01 [1] CRAN (R 4.1.1)</span>
<span class="co">##  pkgbuild        1.3.1   2021-12-20 [1] CRAN (R 4.1.1)</span>
<span class="co">##  pkgconfig       2.0.3   2019-09-22 [1] CRAN (R 4.1.0)</span>
<span class="co">##  pkgload         1.2.4   2021-11-30 [1] CRAN (R 4.1.1)</span>
<span class="co">##  png             0.1-7   2013-12-03 [1] CRAN (R 4.1.0)</span>
<span class="co">##  prettyunits     1.1.1   2020-01-24 [1] CRAN (R 4.1.0)</span>
<span class="co">##  processx        3.5.2   2021-04-30 [1] CRAN (R 4.1.0)</span>
<span class="co">##  proxy           0.4-26  2021-06-07 [1] CRAN (R 4.1.0)</span>
<span class="co">##  ps              1.6.0   2021-02-28 [1] CRAN (R 4.1.0)</span>
<span class="co">##  purrr         * 0.3.4   2020-04-17 [1] CRAN (R 4.1.0)</span>
<span class="co">##  R6              2.5.1   2021-08-19 [1] CRAN (R 4.1.1)</span>
<span class="co">##  Rcpp            1.0.8   2022-01-13 [1] CRAN (R 4.1.1)</span>
<span class="co">##  readr         * 2.1.2   2022-01-30 [1] CRAN (R 4.1.1)</span>
<span class="co">##  readxl        * 1.3.1   2019-03-13 [1] CRAN (R 4.1.0)</span>
<span class="co">##  remotes         2.4.2   2021-11-30 [1] CRAN (R 4.1.1)</span>
<span class="co">##  reprex          2.0.1   2021-08-05 [1] CRAN (R 4.1.1)</span>
<span class="co">##  rgdal           1.5-28  2021-12-15 [1] CRAN (R 4.1.1)</span>
<span class="co">##  rgeos           0.5-9   2021-12-15 [1] CRAN (R 4.1.1)</span>
<span class="co">##  RJSONIO         1.3-1.6 2021-09-16 [1] CRAN (R 4.1.1)</span>
<span class="co">##  rlang           1.0.1   2022-02-03 [1] CRAN (R 4.1.1)</span>
<span class="co">##  rmarkdown       2.11    2021-09-14 [1] CRAN (R 4.1.1)</span>
<span class="co">##  rnaturalearth   0.1.0   2017-03-21 [1] CRAN (R 4.1.0)</span>
<span class="co">##  rprojroot       2.0.2   2020-11-15 [1] CRAN (R 4.1.0)</span>
<span class="co">##  rstudioapi      0.13    2020-11-12 [1] CRAN (R 4.1.0)</span>
<span class="co">##  rvest           1.0.2   2021-10-16 [1] CRAN (R 4.1.1)</span>
<span class="co">##  sass            0.4.0   2021-05-12 [1] CRAN (R 4.1.0)</span>
<span class="co">##  scales        * 1.1.1   2020-05-11 [1] CRAN (R 4.1.0)</span>
<span class="co">##  sessioninfo     1.2.2   2021-12-06 [1] CRAN (R 4.1.1)</span>
<span class="co">##  sf              1.0-6   2022-02-04 [1] CRAN (R 4.1.1)</span>
<span class="co">##  socviz        * 1.2     2020-06-10 [1] CRAN (R 4.1.0)</span>
<span class="co">##  sp              1.4-6   2021-11-14 [1] CRAN (R 4.1.1)</span>
<span class="co">##  stringi         1.7.6   2021-11-29 [1] CRAN (R 4.1.1)</span>
<span class="co">##  stringr       * 1.4.0   2019-02-10 [1] CRAN (R 4.1.1)</span>
<span class="co">##  testthat        3.1.2   2022-01-20 [1] CRAN (R 4.1.1)</span>
<span class="co">##  tibble        * 3.1.6   2021-11-07 [1] CRAN (R 4.1.1)</span>
<span class="co">##  tidyr         * 1.2.0   2022-02-01 [1] CRAN (R 4.1.1)</span>
<span class="co">##  tidyselect      1.1.2   2022-02-21 [1] CRAN (R 4.1.1)</span>
<span class="co">##  tidyverse     * 1.3.1   2021-04-15 [1] CRAN (R 4.1.0)</span>
<span class="co">##  tzdb            0.2.0   2021-10-27 [1] CRAN (R 4.1.1)</span>
<span class="co">##  units           0.8-0   2022-02-05 [1] CRAN (R 4.1.1)</span>
<span class="co">##  usethis         2.1.5   2021-12-09 [1] CRAN (R 4.1.1)</span>
<span class="co">##  utf8            1.2.2   2021-07-24 [1] CRAN (R 4.1.0)</span>
<span class="co">##  vctrs           0.3.8   2021-04-29 [1] CRAN (R 4.1.0)</span>
<span class="co">##  vipor           0.4.5   2017-03-22 [1] CRAN (R 4.1.0)</span>
<span class="co">##  viridisLite     0.4.0   2021-04-13 [1] CRAN (R 4.1.0)</span>
<span class="co">##  vroom           1.5.7   2021-11-30 [1] CRAN (R 4.1.1)</span>
<span class="co">##  WDI           * 2.7.6   2022-02-25 [1] CRAN (R 4.1.1)</span>
<span class="co">##  withr           2.4.3   2021-11-30 [1] CRAN (R 4.1.1)</span>
<span class="co">##  xfun            0.29    2021-12-14 [1] CRAN (R 4.1.1)</span>
<span class="co">##  xml2            1.3.3   2021-11-30 [1] CRAN (R 4.1.1)</span>
<span class="co">##  yaml            2.3.5   2022-02-21 [1] CRAN (R 4.1.1)</span>
<span class="co">## </span>
<span class="co">##  [1] /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library</span>
<span class="co">## </span>
<span class="co">## ──────────────────────────────────────────────────────────────────────────────</span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="intro-data-viz.html"><span class="header-section-number">1</span> Introduction to data visualization</a></div>
<div class="next"><a href="science-polish.html"><span class="header-section-number">3</span> Making plots pretty and clean</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#show-the-numbers"><span class="header-section-number">2</span> Showing the right numbers</a></li>
<li>
<a class="nav-link" href="#learning-objectives-1">Learning objectives</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#morning-1"><span class="header-section-number">2.0.1</span> Morning</a></li>
<li><a class="nav-link" href="#afternoon-1"><span class="header-section-number">2.0.2</span> Afternoon</a></li>
</ul>
</li>
<li><a class="nav-link" href="#assigned-readings-1">Assigned readings</a></li>
<li><a class="nav-link" href="#grammar-of-graphics-review"><span class="header-section-number">2.1</span> Grammar of graphics (review)</a></li>
<li><a class="nav-link" href="#grouped-data-and-the-group-aesthetic"><span class="header-section-number">2.2</span> Grouped data and the group aesthetic</a></li>
<li><a class="nav-link" href="#geoms-can-transform-data"><span class="header-section-number">2.3</span> Geoms can transform data</a></li>
<li>
<a class="nav-link" href="#geom_-functions-call-their-default-stat_-functions-behind-the-scenes"><span class="header-section-number">2.4</span> geom_*() functions call their default stat_*() functions behind the scenes</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#color-in-a-bar-chart"><span class="header-section-number">2.4.1</span> Color in a bar chart</a></li></ul>
</li>
<li>
<a class="nav-link" href="#histograms-and-kernel-densities"><span class="header-section-number">2.5</span> Histograms and kernel densities</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#subsetting-data-on-the-fly"><span class="header-section-number">2.5.1</span> Subsetting data on the fly</a></li></ul>
</li>
<li><a class="nav-link" href="#avoiding-transformations-when-necessary"><span class="header-section-number">2.6</span> Avoiding transformations when necessary</a></li>
<li>
<a class="nav-link" href="#cross-tabulation-the-awkward-way"><span class="header-section-number">2.7</span> Cross-tabulation the awkward way</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#calculate-manually"><span class="header-section-number">2.7.1</span> Calculate manually</a></li></ul>
</li>
<li>
<a class="nav-link" href="#continuous-variables-by-group-or-category"><span class="header-section-number">2.8</span> Continuous variables by group or category</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#boxplots"><span class="header-section-number">2.8.1</span> Boxplots</a></li>
<li><a class="nav-link" href="#coord_flip"><span class="header-section-number">2.8.2</span> coord_flip()</a></li>
<li><a class="nav-link" href="#reorder"><span class="header-section-number">2.8.3</span> reorder()</a></li>
<li><a class="nav-link" href="#strip-chart"><span class="header-section-number">2.8.4</span> Strip chart</a></li>
<li><a class="nav-link" href="#cleveland-dotplot"><span class="header-section-number">2.8.5</span> Cleveland dotplot</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#plot-text-directly"><span class="header-section-number">2.9</span> Plot text directly</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#geom_text"><span class="header-section-number">2.9.1</span> geom_text()</a></li></ul>
</li>
<li>
<a class="nav-link" href="#ggrepelgeom_text_repel"><span class="header-section-number">2.10</span> ggrepel::geom_text_repel()</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#label-outliers-only"><span class="header-section-number">2.10.1</span> Label outliers only</a></li></ul>
</li>
<li>
<a class="nav-link" href="#scales-guides-and-themes"><span class="header-section-number">2.11</span> Scales, guides, and themes</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#labels-breaks-and-limits"><span class="header-section-number">2.11.1</span> Labels, breaks, and limits</a></li></ul>
</li>
<li>
<a class="nav-link" href="#mapping-data-to-graphics"><span class="header-section-number">2.12</span> Mapping data to graphics</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#load-and-clean-data"><span class="header-section-number">2.12.1</span> Load and clean data</a></li>
<li><a class="nav-link" href="#histograms"><span class="header-section-number">2.12.2</span> Histograms</a></li>
<li><a class="nav-link" href="#points"><span class="header-section-number">2.12.3</span> Points</a></li>
<li><a class="nav-link" href="#boxplots-1"><span class="header-section-number">2.12.4</span> Boxplots</a></li>
<li><a class="nav-link" href="#summaries"><span class="header-section-number">2.12.5</span> Summaries</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#amounts-and-proportions"><span class="header-section-number">2.13</span> Amounts and proportions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#load-data"><span class="header-section-number">2.13.1</span> Load data</a></li>
<li><a class="nav-link" href="#wrangle-data"><span class="header-section-number">2.13.2</span> Wrangle data</a></li>
<li><a class="nav-link" href="#bar-plot"><span class="header-section-number">2.13.3</span> Bar plot</a></li>
<li><a class="nav-link" href="#lollipop-chart"><span class="header-section-number">2.13.4</span> Lollipop chart</a></li>
<li><a class="nav-link" href="#strip-plot"><span class="header-section-number">2.13.5</span> Strip plot</a></li>
<li><a class="nav-link" href="#beeswarm-plot"><span class="header-section-number">2.13.6</span> Beeswarm plot</a></li>
<li><a class="nav-link" href="#heatmap"><span class="header-section-number">2.13.7</span> Heatmap</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#comparisons"><span class="header-section-number">2.14</span> Comparisons</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#load-and-clean-data-1"><span class="header-section-number">2.14.1</span> Load and clean data</a></li>
<li><a class="nav-link" href="#small-multiples"><span class="header-section-number">2.14.2</span> Small multiples</a></li>
<li><a class="nav-link" href="#sparklines"><span class="header-section-number">2.14.3</span> Sparklines</a></li>
<li><a class="nav-link" href="#slopegraphs"><span class="header-section-number">2.14.4</span> Slopegraphs</a></li>
<li><a class="nav-link" href="#bump-charts"><span class="header-section-number">2.14.5</span> Bump charts</a></li>
</ul>
</li>
<li><a class="nav-link" href="#acknowledgments">Acknowledgments</a></li>
<li><a class="nav-link" href="#session-info-1">Session info</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Data Visualization</strong>: MACS 20700/40700" was written by Benjamin Soltoff. It was last built on 2022-03-04.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
