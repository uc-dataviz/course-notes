---
title: "Introduction to data visualization"
author: "MACS 24000 <br /> University of Chicago"
output: rcfss::xaringan_wide
---

```{r setup, include=FALSE}
# create xaringan-themer.css
rcfss::xaringan_theme()

options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(
  cache = TRUE,
  message = FALSE,
  echo = FALSE,
  fig.width = 8, fig.asp = 0.618, fig.retina = 3, dpi = 300,
  fig.showtext = FALSE,
  fig.align = "center",
  out.width = "90%"
  )

set.seed(1234)
```

```{r packages, include = FALSE, cache = FALSE}
library(tidyverse)
library(knitr)
library(stringr)
library(broom)
library(datasauRus)
library(gganimate)
library(socviz)
library(patchwork)
library(rcfss)
library(tidycensus)
library(statebins)
library(here)

theme_set(theme_minimal(base_size = rcfss::base_size))
```

# Why visualize data?

* Statistical methods
* Machine learning
* Drawing a picture

---

# Anscombe's quartet

```{r anscombe}
# tidy the dataset
# source: https://gist.github.com/amoeba/7576126
anscombe_tidy <- map_df(.x = 1:4, ~ tibble(set = .x,
                                           x = anscombe[, .x],
                                           y = anscombe[, .x + 4]))

ggplot(data = anscombe_tidy,
       mapping = aes(x = x, y = y)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, fullrange = TRUE) +
  facet_wrap(~ set) +
  labs(title = "Anscombe's quartet",
       x = expression(X),
       y = expression(Y))
```

---

# Datasaurus dozen

.center[

```{r datasaurus-graph-static, fig.height = 8, fig.width = 8}
ggplot(datasaurus_dozen, aes(x = x, y = y)) +
  facet_wrap(~ dataset) +
  geom_point() +
  theme_minimal()
```

]

---

# Outlier detection

```{r south-africa-outlier, out.height = "500px", echo = TRUE}
knitr::include_graphics("https://socviz.co/assets/ch-01-jackman-outlier.png")
```

---

class: inverse

# What makes visualizations bad

---

# Lies

```{r gas, out.width = "150%"}
knitr::include_graphics(here("images", "cost_of_gas.jpg"))
```

---

# Dual axes

```{r nic-cage}
knitr::include_graphics(here("images", "drowning_cage.jpeg"))
```

---

# Lacking functionality

```{r bush-tax-cuts, out.width = "130%"}
knitr::include_graphics(here("images", "Bush_cuts2.png"))
```

---

# Lacking functionality

```{r gun-deaths}
knitr::include_graphics(here("images", "stand_your_ground.jpg"))
```

---

# Junky

```{r death-penalty, out.width = "130%"}
knitr::include_graphics(here("images", "death_penalty.jpg"))
```

---

# Purpose of visualizations

> Any kind of visual representation of information designed to enable communication, analysis, discovery, exploration, etc.

--

* What is your goal?
* How do you design a visualization to meet that goal?

---

# Statistical graphics

* Visualize abstract data typically of the quantitative form
* Convey data accurately and reveal the underlying structure
* Lack exploration and interaction

---

# Double-time bar charts

```{r double-bar-chart, out.width = "150%"}
knitr::include_graphics("https://dougmccune.com/blog/wp-content/uploads/2011/04/burglary1.png")
```
    
---

# Double-time bar charts

```{r double-bar-chart-facet}
knitr::include_graphics("https://dougmccune.com/blog/wp-content/uploads/2011/04/small_multiples_small.png")
```

---

# Information dashboards

* Popular in business and industry
* Visualize abstract data, frequently (though not always) over time
* Convey large amounts of information quickly
* Extremely dense

--

#### Examples

* [COVID-19 United States Cases by County](https://coronavirus.jhu.edu/us-map)
* [California COVID Assessment Tool](https://calcat.covid19.ca.gov/cacovidmodels/) - built in Shiny!

---

# Infographics

* Depict abstract data in an effort to be eye-catching and capture attention
* Convey information quickly
* Easy to go wrong

---

# Sexual sun stroke

```{r sexual-sun-stroke}
knitr::include_graphics("https://klientboost.com/wp-content/uploads/2013/05/1.jpg")
```

---

# What is that?

```{r terrible-area-chart}
knitr::include_graphics("https://i.kinja-img.com/gawker-media/image/upload/b5icpqdsnzsdaezvnrm1.jpg")
```

---

# Huh?

```{r paid-maternity-leave, out.height = "500px"}
knitr::include_graphics("https://68.media.tumblr.com/fd2be427c6794cc8e25bc23c42da73aa/tumblr_omvcm7m9va1sgh0voo1_1280.jpg")
```

---

# What makes a good visualization

From *The Truthful Art*

* Is it truthful?
* Is it functional?
* Is it beautiful?
* Is it insightful?
* Is it enlightening?

---

# Dr. John Snow

```{r snow, out.width = "70%"}
knitr::include_graphics("https://upload.wikimedia.org/wikipedia/commons/thumb/2/27/Snow-cholera-map-1.jpg/819px-Snow-cholera-map-1.jpg")
```

---

# Napoleon's march on Russia

```{r minard-orig}
knitr::include_graphics("https://upload.wikimedia.org/wikipedia/commons/2/29/Minard.png")
```

---

# Napoleon's march on Russia

```{r minard-translate}
knitr::include_graphics("https://upload.wikimedia.org/wikipedia/commons/e/e2/Minard_Update.png")
```


---

# Perception and data visualization

* Driven by science
* Lots to learn here, but we don't have time this week to dive in deep!
* Important to remember human perception and cognition is a process - design visualizations remembering this fact
* Work to simplify perception so the story is clear and easy to tell

---

# Visual tasks and decoding graphs

```{r cleveland}
knitr::include_graphics("https://socviz.co/assets/ch-01-cleveland-task-types.png")
```

---

# Visual tasks and decoding graphs

```{r cleveland-replication, out.height = "500px"}
knitr::include_graphics("https://socviz.co/assets/ch-01-heer-bostock-results.png")
```

---

# Channels and decoding information

```{r channels-ordered-data, out.height = "500px"}
knitr::include_graphics("https://socviz.co/assets/ch-01-channels-for-cont-data-vertical.png")
```

---

# Channels and decoding information

```{r channels-unordered-data, out.height = "500px"}
knitr::include_graphics("https://socviz.co/assets/ch-01-channels-for-cat-data-vertical.png")
```

---

# Bar chart vs. pie chart

```{r bar-pie}
gss_auth <- gss_colrac %>%
  count(authoritarianism) %>%
  mutate(authoritarianism = factor(authoritarianism)) %>%
  mutate(pct = n / sum(n))

# bar chart
auth_bar <- ggplot(gss_auth, aes(authoritarianism, pct, fill = authoritarianism)) +
  geom_col() +
  scale_y_continuous(labels = scales::percent) +
  scale_fill_brewer(palette = "OrRd", guide = FALSE) +
  labs(x = "Authoritarianism scale\n(higher indicates more support for authoritarian government)",
       y = "Percentage of respondents")

# pie chart
auth_pie <- ggplot(gss_auth, aes(x = factor(1), y = pct, fill = authoritarianism)) +
  geom_col(width = 1) +
  geom_text(aes(label = authoritarianism), position = position_stack(vjust = 0.5), size = 7) +
  coord_polar(theta = "y", direction = -1) +
  scale_fill_brewer(palette = "OrRd", guide = FALSE) +
  labs(x = "Authoritarianism scale\n(higher indicates more support for authoritarian government)",
       y = "Percentage of respondents") +
  theme_void(base_size = rcfss::base_size)

auth_bar +
  auth_pie +
  plot_annotation(title = "Public support for authoritarianism",
                  caption = "Source: General Social Survey (2012)",
                  tag_levels = "A") +
  plot_layout(widths = c(50, 50))
```

---

# Choropleths

```{r maps, fig.asp = .8}
us_sf <- get_acs(geography = "state", 
                 variables = c(medincome = "B19013_001"), 
                 year = 2016,
                 geometry = TRUE,
                 shift_geo = TRUE)

trump_map <- left_join(us_sf, election, by = c("NAME" = "state")) %>%
  ggplot(mapping = aes(fill = pct_trump)) +
  geom_sf() +
  scale_fill_distiller(palette = "Reds", labels = scales::percent_format(scale = 1)) +
  labs(fill = "Percent Trump") +
  theme_void() +
  theme(legend.position = "bottom")

trump_statebins <- ggplot(data = election, mapping = aes(state = state, fill = pct_trump)) +
  geom_statebins()  +
  coord_equal() +
  scale_fill_distiller(palette = "Reds", labels = scales::percent_format(scale = 1), guide = FALSE) +
  labs(fill = "Percent Trump") +
  theme_statebins(base_size = rcfss::base_size) +
  theme(legend.position = "bottom")

# lollipop chart
trump_lollipop <- ggplot(data = election,
                         mapping = aes(y = reorder(state, pct_trump), x = pct_trump,
                                       color = pct_trump)) +
  geom_pointrange(aes(xmin = 0, xmax = pct_trump),
                  fatten = 3, size = .7) +
  scale_color_distiller(palette = "Reds", labels = scales::percent_format(scale = 1), guide = FALSE) +
  labs(y = NULL,
       x = "Percent Trump") +
  theme_minimal(base_size = rcfss::base_size * .6)

(trump_lollipop | (trump_map / trump_statebins +
                     plot_layout(guides = "collect"))) +
  plot_annotation(title = "2016 US Presidential Election", tag_levels = "A") +
  plot_layout(ncol = 2, byrow = FALSE) &
  theme(legend.position = 'bottom')
```

---

# Identifying appropriate graphical forms

1. Think about the task or tasks you want to enable
1. Try different graphic forms
1. Arrange the components of the graphic
1. Test the outcomes

---

# What is the story?

```{r piketty, out.height = "500px", out.width = "340px"}
knitr::include_graphics(here("images", "ta_piketty.jpeg"))
```

---

## GitHub

.center[.large[https://github.com/vizdata-f21]]

<br>

- GitHub organization for the course

- All of your work and your membership (enrollment) in the organization is private

- Each assignment is a private repo on GitHub, I distribute the assignments on GitHub and you submit them there

- Feedback on assignments is given as GitHub issues, only points recorded on Sakai gradebook

.task[
Fill out the *Getting to know you* survey for collection of your account names, later this week you will be invited to the course organization.
]
